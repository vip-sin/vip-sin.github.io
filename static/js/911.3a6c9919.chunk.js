"use strict";(self.webpackChunkvpn=self.webpackChunkvpn||[]).push([[911],{77911:function(e,n,t){t.r(n),t.d(n,{default:function(){return R}});var i=t(1413),a=t(93433),l=t(74165),o=t(15861),r=t(29439),s=t(47313),d=t(95162),u=t(64162),c=t.n(u),f=t(40229),v=t(71535),p=t(96900),h=t(56972),m=t(62463),x=t(89870),y=t(39653),g=t(96327),Z=t(39995),b=t(13798),j=t(31881),k=t.n(j),S=t(66135),D=t(12613),P=t(86282),w=t(61474),A=t(35192),L=t(6039),C=t(50850),I=t(71363),F=t(54727),N=t(46417),E=function(e,n,t,i,a,l,o){var r=[];(null===o||void 0===o?void 0:o.length)&&o.forEach((function(l,o){if(l.id){var s,d,u,c="";(null===l||void 0===l||null===(s=l.nominees)||void 0===s?void 0:s.length)&&l.nominees.forEach((function(n,t){var i=e.data.filter((function(e){return e._id===n.id}));i.length&&(t===l.nominees.length-1?c+=i[0].name:c="".concat(c+i[0].name,", "))}));var f=null,p=(0,N.jsxs)(v.ZP,{container:!0,columnSpacing:1,children:[(0,N.jsx)(v.ZP,{item:!0,display:"flex",sm:4,xs:12,children:(0,N.jsxs)(v.ZP,{container:!0,children:[(0,N.jsx)(v.ZP,{item:!0,xs:4,children:(0,N.jsx)(I.Z,{borderRadius:1,textAlign:"center",height:"max-cotent",bgcolor:"#3f3fcb",color:"white",padding:.1,sx:{cursor:"pointer"},onClick:function(){return t(l)},children:"EDIT"})}),(0,N.jsx)(v.ZP,{item:!0,xs:4,children:(0,N.jsx)(I.Z,{borderRadius:1,textAlign:"center",height:"max-cotent",bgcolor:"#e53a29",color:"white",padding:.1,sx:{mx:1,cursor:"pointer"},onClick:function(){i(l.id),a(!0)},children:"DELETE"})})]})}),l.liabilityDetails.map((function(e,t){if("Remarks"===e.key&&e.val)return f=t,"";if(""!==e.val){var i,a=e.val;if("File"===e.type){var l=e.val.split("#~#");a=(0,N.jsx)("u",{children:(0,N.jsx)("span",{style:{color:"blue",cursor:"pointer"},onClick:function(){return n(l[2])},children:l[0]})})}return(0,N.jsx)(v.ZP,{item:!0,sm:4,xs:12,children:(0,N.jsxs)(v.ZP,{container:!0,children:[(0,N.jsx)(v.ZP,{item:!0,xs:5,children:(0,N.jsx)(I.Z,{children:e.key&&(null===(i=e.key.split("*"))||void 0===i?void 0:i[0])})}),(0,N.jsx)(v.ZP,{item:!0,xs:7,children:(0,N.jsxs)(I.Z,{children:[": ","Date"===e.type?(0,F.p6)(a):a]})})]})},t+e.key)}return""})),(0,N.jsx)(v.ZP,{item:!0,sm:4,xs:12,children:(0,N.jsxs)(v.ZP,{container:!0,children:[(0,N.jsx)(v.ZP,{item:!0,xs:5,children:(0,N.jsx)(I.Z,{children:"Nominees"})}),(0,N.jsx)(v.ZP,{item:!0,xs:7,children:(0,N.jsxs)(I.Z,{children:[": ",c]})})]})}),f&&(0,N.jsx)(v.ZP,{item:!0,sm:4,xs:12,children:(0,N.jsxs)(v.ZP,{container:!0,children:[(0,N.jsx)(v.ZP,{item:!0,xs:5,children:(0,N.jsx)(I.Z,{children:(null===l||void 0===l?void 0:l.liabilityDetails[f].key)&&(null===l||void 0===l||null===(d=l.liabilityDetails[f].key.split("*"))||void 0===d?void 0:d[0])})}),(0,N.jsx)(v.ZP,{item:!0,xs:7,children:(0,N.jsxs)(I.Z,{children:[": ",null===l||void 0===l||null===(u=l.liabilityDetails[f])||void 0===u?void 0:u.val]})})]})})]}),h={id:o+1,trashIt:function(){i(l.id),a(!0)},editIt:function(){t(l)},title:l.liabilityType,content:p};r.push(h)}})),l(null===r||void 0===r?void 0:r.reverse())},O=t(97729),B=t(36936),_=t(23317),z=t(72845),R=(0,S.$j)((function(e){var n,t,i=e.reducer,a=i.dataList,l=i.customizer,o=void 0===l?{}:l;return{dataList:a,liabilityListFromAPI:null!==(n=null===a||void 0===a?void 0:a.liabilityListFromAPI)&&void 0!==n?n:[],messages:null===o||void 0===o||null===(t=o.language)||void 0===t?void 0:t.Liability,listLoading:null===a||void 0===a?void 0:a.totalRecordsLoading,mediaData:null===a||void 0===a?void 0:a.mediaData}}),(function(e){return{previewDoc:function(n){return e(z.Xg.endpoints.previewDoc.initiate(n,{subscribe:!1,forceRefetch:!0}))},resetPreview:function(n){return e(z.Xg.endpoints.resetPreview.initiate(n))},getData:function(n){return e(B.SD.endpoints.getData.initiate())},addLiabilityData:function(n){return e(_.sk.endpoints.addLiabilityData.initiate(n))},addData:function(n){return e(B.SD.endpoints.addData.initiate(n))},callLiabilityAPI:function(n){return e(_.sk.endpoints.getLiabilityData.initiate())}}}))((function(e){var n,t,u,j=(0,s.createRef)(),S=e.messages,I=e.thumbView,B=e.getData,_=e.parsedFilter,z=e.callLiabilityAPI,R=e.liabilityListFromAPI,T=e.addLiabilityData,M=e.previewDoc,J=e.mediaData,G=e.resetPreview,U=JSON.parse(sessionStorage.getItem("dropdowns")).liabilityOption,V=JSON.parse(sessionStorage.getItem("logInUserData")),Q=Object.keys(U).map((function(e){var n,t;return{value:e,label:null!==(n=null===S||void 0===S||null===(t=S.colorOption)||void 0===t?void 0:t[e])&&void 0!==n?n:e,color:"#00B8D9",isFixed:!0}})),W=(0,s.useState)(!1),X=(0,r.Z)(W,2),Y=X[0],K=X[1],$=(0,s.useState)(!1),q=(0,r.Z)($,2),H=q[0],ee=q[1],ne=(0,s.useState)(null),te=(0,r.Z)(ne,2),ie=te[0],ae=te[1],le=(0,s.useState)(""),oe=(0,r.Z)(le,2),re=oe[0],se=oe[1],de=(0,s.useState)(""),ue=(0,r.Z)(de,2),ce=ue[0],fe=ue[1],ve=(0,s.useState)(!0),pe=(0,r.Z)(ve,2),he=pe[0],me=pe[1],xe=(0,s.useState)([]),ye=(0,r.Z)(xe,2),ge=ye[0],Ze=ye[1],be=(0,s.useState)(""),je=(0,r.Z)(be,2),ke=je[0],Se=je[1],De=(0,s.useState)(!1),Pe=(0,r.Z)(De,2),we=Pe[0],Ae=Pe[1],Le=(0,s.useState)(!1),Ce=(0,r.Z)(Le,2),Ie=Ce[0],Fe=Ce[1],Ne=(0,s.useState)(null),Ee=(0,r.Z)(Ne,2),Oe=Ee[0],Be=Ee[1],_e=(0,s.useState)(!1),ze=(0,r.Z)(_e,2),Re=ze[0],Te=ze[1],Me=(0,s.useState)(!1),Je=(0,r.Z)(Me,2),Ge=Je[0],Ue=Je[1],Ve=(0,s.useState)(!1),Qe=(0,r.Z)(Ve,2),We=Qe[0],Xe=Qe[1],Ye=(0,s.useState)([]),Ke=(0,r.Z)(Ye,2),$e=Ke[0],qe=Ke[1],He=(0,s.useState)(!1),en=(0,r.Z)(He,2),nn=en[0],tn=en[1],an=(0,s.useState)(),ln=(0,r.Z)(an,2),on=ln[0],rn=ln[1],sn=(0,s.useState)([]),dn=(0,r.Z)(sn,2),un=dn[0],cn=dn[1],fn=(0,s.useState)(""),vn=(0,r.Z)(fn,2),pn=vn[0],hn=vn[1],mn=(0,s.useState)(!1),xn=(0,r.Z)(mn,2),yn=xn[0],gn=xn[1],Zn=(0,s.useState)(""),bn=(0,r.Z)(Zn,2),jn=bn[0],kn=bn[1],Sn=(0,s.useState)(!0),Dn=(0,r.Z)(Sn,2),Pn=Dn[0],wn=Dn[1],An=(0,s.useState)(!1),Ln=(0,r.Z)(An,2),Cn=Ln[0],In=Ln[1],Fn=(0,s.useState)(),Nn=(0,r.Z)(Fn,2),En=Nn[0],On=Nn[1],Bn=(0,s.useState)([{value:"Add Nominee",label:"Add Nominee",color:"#00B8D9",isFixed:!1}]),_n=(0,r.Z)(Bn,2),zn=_n[0],Rn=_n[1];(0,s.useEffect)((function(){!e.listLoading&&B(),z()}),[]),(0,s.useEffect)((function(){R&&E(e.dataList,Un,tt,ae,K,Ze,R)}),[R]),(0,s.useEffect)((function(){if(e.dataList.data.length){var n=[{value:"Add Nominee",label:"Add Nominee",color:"#00B8D9",isFixed:!1}];e.dataList.data.forEach((function(e){var t={value:e._id,label:"".concat(e.name," - ").concat(e.relation),color:"#00B8D9",isFixed:!1};n.push(t)})),Rn(n)}}),[e.dataList]);var Tn=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Fe(e),!0===n&&(Be(null),Ae(!0))},Mn=function(){var n=(0,o.Z)((0,l.Z)().mark((function n(t){return(0,l.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return Te(!0),n.prev=1,n.next=4,e.addData(t);case 4:Te(!1),Tn(!1,!0),n.next=12;break;case 8:return n.prev=8,n.t0=n.catch(1),Te(!1),n.abrupt("return",(0,N.jsx)(D.A9,{handleClick:function(){},openSnack:!0,openSnackMsg:"Add Nominee Failed! Please contact admin",severity:"error"}));case 12:case"end":return n.stop()}}),n,null,[[1,8]])})));return function(e){return n.apply(this,arguments)}}(),Jn=sessionStorage.getItem("authtoken"),Gn=function(){var e=(0,o.Z)((0,l.Z)().mark((function e(n){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k().delete("/backendapi/document/deletebyid/".concat(n),{headers:{Authorization:"Bearer ".concat(Jn)}}).then((function(e){return(0,N.jsx)(D.A9,{handleClick:function(){},openSnack:!0,openSnackMsg:pn&&on?"Attachment Replaced Successfully":"Attachment removed Successfully"})})).catch((function(e){console.log("err",e)})).finally((function(){et(),nt(),wn(!0)}));case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();(0,s.useEffect)((function(){J&&(On(J),Ue(!1))}),[J]);var Un=function(){var e=(0,o.Z)((0,l.Z)().mark((function e(n){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,Xe(!0),Ue(!0),e.next=5,M(n);case 5:e.next=12;break;case 7:return e.prev=7,e.t0=e.catch(0),Vn(),Xe(!We),e.abrupt("return",(0,N.jsx)(D.A9,{handleClick:function(){},openSnack:!0,openSnackMsg:"Something went wrong",severity:"warning"}));case 12:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(n){return e.apply(this,arguments)}}(),Vn=function(){tn(!nn)},Qn=function(e,n,t){var i;"File"===n.type&&rn(null===(i=t.target)||void 0===i?void 0:i.files[0]);var a=un,l=a.findIndex((function(e){return e.key===n.key}));e.length<50&&(a[l].val=e,cn(a),ee(!H),Wn())},Wn=function(){var e=!1;un.forEach((function(n){n.mandatory&&!n.val.trim()&&(e=!0)})),wn(e)},Xn=function(e){return new Promise((function(n,t){var i=new FileReader;i.readAsDataURL(e),i.onload=function(){return n(i.result)},i.onerror=function(e){return t(e)}}))},Yn=function(){var e=(0,o.Z)((0,l.Z)().mark((function e(n){var t,i,a,o,r,s;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],(i={}).user=null===V||void 0===V?void 0:V._id,i.type="Liability",i.alias=(0,O.Gf)(n.name),e.next=7,Xn(n);case 7:return a=e.sent,o=(0,O.Gf)(a),r=c().compressToUTF16(o),t.push({media:r,name:n.name,type:n.type,user:null===V||void 0===V?void 0:V._id}),i.attachment=t,e.next=14,k().post("/backendapi/documents/add",i,{headers:{Authorization:"Bearer ".concat(sessionStorage.getItem("authtoken"))}});case 14:return s=e.sent,e.abrupt("return",s);case 16:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),Kn=function(n){In(!0),n.preventDefault(),pn&&!on&&un.forEach((function(e){"Attachments"===e.key&&(e.val="")}));var t={liabilityType:ke,liabilityDetails:(0,P.OQ)(un),nominees:$e,id:jn},i=R.findIndex((function(e){return e.id===jn}));i>=0&&(R.splice(i,1),R.push(t),k().post("/backendapi/adddetails",{_id:null===V||void 0===V?void 0:V._id,liabilities:(0,O.Gf)(JSON.stringify(R)),nominees:$e},{headers:{Authorization:"Bearer ".concat(sessionStorage.getItem("authtoken"))}}).then((function(n){pn&&Gn(pn),D.A9,B(e.parsedFilter),z(),In(!1)})).catch((function(){In(!1)})),et(),nt(),wn(!0))},$n=function(e){In(!0),e.preventDefault(),gn(!1);var n=un.findIndex((function(e){return"File"===e.type}));n>=0&&on?""!==un[n].val?Yn(on).then((function(t){un[n].val="".concat((0,O.Y)(t.data.alias),"#~#").concat(t.data._id,"#~#").concat(t.data.attachment[0]),cn(un),Kn(e)})).catch((function(e){var n,t;In(!1),(null===e||void 0===e||null===(n=e.response)||void 0===n?void 0:n.data)&&(D.A9,null===e||void 0===e||null===(t=e.response)||void 0===t||t.data)})):Kn(e):Kn(e)},qn=function(){var n={liabilityType:ke,liabilityDetails:(0,P.OQ)(un),nominees:$e,id:(0,d.Z)()};return $e.forEach((function(e){e.objectid=n.id})),R.push(n),k().post("/backendapi/adddetails",{_id:null===V||void 0===V?void 0:V._id,liabilities:(0,O.Gf)(JSON.stringify(R)),nominees:$e},{headers:{Authorization:"Bearer ".concat(sessionStorage.getItem("authtoken"))}}).then((function(n){B(e.parsedFilter),z(),In(!1)})).catch((function(){In(!1)})),et(),nt(),wn(!0),(0,N.jsx)(D.A9,{handleClick:function(){},openSnack:!0,openSnackMsg:"Liability addedd successfully!"})},Hn=function(e){In(!0),e.preventDefault();var n=un.findIndex((function(e){return"File"===e.type}));n>=0?""!==un[n].val?Yn(on).then((function(e){un[n].val="".concat((0,O.Y)(e.data.alias),"#~#").concat(e.data._id,"#~#").concat(e.data.attachment[0]),cn(un),qn()})).catch((function(e){var n,t;In(!1),(null===e||void 0===e||null===(n=e.response)||void 0===n?void 0:n.data)&&(D.A9,null===e||void 0===e||null===(t=e.response)||void 0===t||t.data)})):qn():qn()},et=function(){R&&E(e.dataList,Un,tt,ae,K,Ze,R),Se(""),hn(""),rn(""),cn([]),qe([]),yn&&wn(!0)},nt=function(){se(""),fe(""),j.current&&j.current.select.clearValue()},tt=function(e){var n=e.liabilityDetails,t=e.liabilityType,i=e.nominees;Se(t),gn(!0),kn(e.id),cn(n),qe((0,a.Z)(i))};return(0,N.jsxs)(f.Z,{children:[(0,N.jsx)(C.zV,{prviewmodal:We,setprviewmodal:Xe,loading:Ge,blobUrl:En,reset:function(){return G()}}),(0,N.jsx)(g.Z,{modalMessage:"Are you sure you want to delete this record?",handleConfirm:function(){!function(e){var n=JSON.parse(JSON.stringify(R)),t=n.findIndex((function(n){return n.id===e})),i=[];if(console.log(t,"id"),t>=0){var a=n[t].liabilityDetails.filter((function(e){return"File"===e.type}));console.log(a),a.forEach((function(e){var n=e.val.split("#~#");null!==n&&void 0!==n&&n[1]&&(console.log("liability delete",n),k().delete("/backendapi/document/deletebyid/".concat(n[1]),{headers:{Authorization:"Bearer ".concat(sessionStorage.getItem("authtoken"))}}))})),n[t].nominees.forEach((function(e){e.objectid=n[t].id,i.push(e)})),n.splice(t,1),T({_id:null===V||void 0===V?void 0:V._id,liabilities:(0,O.Gf)(JSON.stringify(n)),nominees:$e,deletednominee:i}),et(),nt(),wn(!0),D.A9}}(ie),K(!1)},isOpen:Y,closeModal:function(){return K(!1)}}),(0,N.jsx)(L.Z,{show:Ie,data:Oe,updateData:e.updateData,addData:Mn,isLoading:Re,handleSidebar:Tn,thumbView:I,getData:B,dataParams:_,addNew:we}),(0,N.jsxs)(v.ZP,{container:!0,spacing:2,sx:{p:2},children:[(0,N.jsx)(v.ZP,{item:!0,xs:12,md:9,lg:9,children:(0,N.jsx)(p.Z,{children:(0,N.jsxs)(h.Z,{children:[(0,N.jsx)(D.ll,{title:yn?"Edit Liability Details":"Add New Liability"}),(0,N.jsxs)(v.ZP,{rowSpacing:.01,container:!0,spacing:1,children:[(0,N.jsx)(v.ZP,{item:!0,xs:12,sm:6,children:(0,N.jsx)(w.gc,{name:"liability",isDisabled:yn,options:Q,id:"liabilityID",onChange:function(e,n){return function(e){var n;wn(!0),(0,P.L9)(),se(""),fe(""),qe([]),rn(""),Se(null!==(n=null===e||void 0===e?void 0:e.value)&&void 0!==n?n:void 0),cn(e?U[e.value]:{})}(n)},value:(0,P.NA)(Q,ke),renderInput:function(e){var n;return(0,N.jsx)(y.Z,(0,i.Z)((0,i.Z)({},e),{},{placeholder:null!==(n=null===S||void 0===S?void 0:S.liabilityOptionText)&&void 0!==n?n:"Liability Type"}))}})}),(0,N.jsx)(v.ZP,{item:!0,xs:12,sm:6,children:(0,N.jsx)(w.gc,{isMulti:!0,id:"nominee",name:"nominee",options:null===zn||void 0===zn?void 0:zn.filter((function(e){return!$e.some((function(n){return n.id===e.value}))})),value:$e.map((function(e){var n=zn.filter((function(n){return n.value===e.id}));return{value:n[0].value,label:n[0].label}})),onChange:function(e,n){return function(e){yn&&wn(!1);var n=[];(null===e||void 0===e?void 0:e.length)&&e.forEach((function(e){"Add Nominee"===e.value?Fe(!0):n.push({id:e.value,name:e.label})})),qe([].concat(n))}(n)},renderInput:function(e){var n;return(0,N.jsx)(y.Z,(0,i.Z)((0,i.Z)({},e),{},{placeholder:null!==(n=null===S||void 0===S?void 0:S.nomineeOption)&&void 0!==n?n:"Nominee(s)"}))}})}),Object.keys(U).includes(ke)&&un.map((function(e,n){return(0,N.jsx)(v.ZP,{item:!0,xs:12,sm:6,children:"Attachments"!==e.key?(0,N.jsxs)(N.Fragment,{children:[e.deletable&&(0,N.jsx)(A.Z,{size:15,onClick:function(){return function(e){yn&&wn(!1);var n=un.filter((function(n){return e.key!==n.key}));cn(n)}(e)}}),(0,N.jsx)(y.Z,{margin:"normal",size:"small",fullWidth:!0,type:e.type,onKeyPress:function(n){"number"===e.type.toLowerCase()&&((0,F.ZP)(n),function(e){var n=(null===e||void 0===e?void 0:e.keyCode)||(null===e||void 0===e?void 0:e.which),t=document.getElementById("liabSubmit");13===n&&(!t||t.disabled||Cn||(yn?$n(e):Hn(e)))}(n))},name:e.key,id:e.id,rows:"1",className:"input-label placeholder ",placeholder:e.key,max:"9999-12-31",min:"1900-01-01",value:"File"!==e.type?e.val:null,onChange:function(n){Qn(n.target?n.target.value:n.value,e,n)}})]}):yn&&!pn&&e.val.split("#~#")[1]?(0,N.jsxs)("div",{className:"form-control",children:[(0,N.jsx)(A.Z,{style:{position:"absolute",right:"-5px",top:"-7px"},className:"primary",size:15,onClick:function(){hn(e.val.split("#~#")[1])}}),(0,N.jsx)("span",{style:{color:"blue"},onClick:function(){Un(e.val.split("#~#")[2])},children:e.val.split("#~#")[0]})]}):(0,N.jsx)(y.Z,{margin:"normal",size:"small",fullWidth:!0,type:e.type,value:null,id:"fileAtt",onChange:function(n){Qn(n.target?n.target.value:n.value,e,n)}})},n)}))]}),(0,N.jsxs)(m.Z,{direction:"row",spacing:3,sx:{mt:3},justifyContent:"end",children:[ke&&(0,N.jsx)(x.Z,{onClick:Vn,children:"Add Custom Field"}),(0,N.jsx)(w.ZP,{varient:"outlined",label:yn?"Cancel":null!==(n=null===S||void 0===S?void 0:S.resetButton)&&void 0!==n?n:"Reset",onClick:function(e){gn(!1),et()}}),(0,N.jsx)(w.ZP,{varient:"contained",id:"assetSubmit",spinload:Cn,label:yn?"Update":null!==(t=null===S||void 0===S?void 0:S.submitButton)&&void 0!==t?t:"Add",disabled:!pn&&(0===$e.length||!ke||Pn||Cn),onClick:function(e){yn?$n(e):Hn(e)}})]})]})})}),(0,N.jsx)(Z.Z,{}),(0,N.jsx)(v.ZP,{xs:12,md:9,lg:9,sx:{pt:2,pl:2},children:(0,N.jsx)(b.ZP,{heading:null!==(u=null===S||void 0===S?void 0:S.textList)&&void 0!==u?u:"Liabilities List",isLoading:e.listLoading,collapseItems:ge,show:function(){me(!he),z()},assetShow:he})})]}),(0,N.jsx)(C.Id,{modal:nn,fname:re,ftype:ce,loading:Ge,addfield:function(){if(""!==ke){var e=un,n=e.length,t="";if(e.findIndex((function(e){return e.key===re}))>=0)return(0,N.jsx)(D.A9,{handleClick:function(){},openSnack:!0,openSnackMsg:"Field Already Exist! Please add new field",severity:"error"});"Attachments"===un[n-1].key?(t=e[n-1],e[n-1]={key:re,val:"",type:ce,deletable:!0},e.push(t),cn(e),se(""),fe("")):(e.push({key:re,val:"",type:ce,deletable:!0}),cn(e),se(""),fe("")),Vn()}},messages:S,setfname:se,setftype:fe,assetType:ke,toggleModal:Vn,selectCustomRef:j,clearCustomField:nt})]})}))}}]);