"use strict";(self.webpackChunkvpn=self.webpackChunkvpn||[]).push([[934],{48934:function(e,t,n){n.r(t);var a=n(1413),i=n(93433),r=n(74165),o=n(15861),s=n(29439),u=n(47313),c=n(95162),l=n(64162),d=n.n(l),f=n(9506),v=n(19641),p=n(57775),h=n(51057),m=n(35898),x=n(71003),Z=n(39653),g=n(34203),y=n(81800),k=n(13798),S=n(31881),b=n.n(S),D=n(66135),j=n(12613),w=n(86282),A=n(61474),I=n(35192),C=n(29748),P=n(50850),L=n(97729),F=n(54727),E=n(45561),O=n(30879),N=n(72845),B=n(46417);t.default=(0,D.$j)((function(e){var t,n,a=e.reducer,i=a.dataList,r=a.customizer,o=void 0===r?{}:r;return{dataList:i,messages:null===o||void 0===o||null===(t=o.language)||void 0===t?void 0:t.Asset,assetListFromAPI:null!==(n=null===i||void 0===i?void 0:i.assetListFromAPI)&&void 0!==n?n:[],listLoading:null===i||void 0===i?void 0:i.totalRecordsLoading,removedDocSuccess:null===i||void 0===i?void 0:i.removedDocSuccess,removingDocfailed:null===i||void 0===i?void 0:i.removingDocfailed,mediaData:null===i||void 0===i?void 0:i.mediaData}}),(function(e){return{getData:function(t){return e(E.SD.endpoints.getData.initiate(t))},resetPreview:function(t){return e(N.Xg.endpoints.resetPreview.initiate(t))},addData:function(t){return e(E.SD.endpoints.addData.initiate(t))},callAssetAPI:function(t){return e(O.aN.endpoints.getAssetData.initiate(t))},deleteWholeDoc:function(t){return e(N.Xg.endpoints.deleteDoc.initiate(t))},previewDoc:function(t){return e(N.Xg.endpoints.previewDoc.initiate(t,{subscribe:!1,forceRefetch:!0}))}}}))((function(e){var t,n,l,S=(0,u.createRef)(),D=e.messages,E=e.getData,O=e.listLoading,N=e.parsedFilter,_=e.assetListFromAPI,z=e.callAssetAPI,M=e.dataList,T=e.removedDocSuccess,R=e.removingDocfailed,G=e.deleteWholeDoc,J=e.previewDoc,U=e.resetPreview,V=JSON.parse(sessionStorage.getItem("dropdowns")).assetOption,W=JSON.parse(sessionStorage.getItem("logInUserData")),X=Object.keys(V).map((function(e){var t,n;return{value:e,label:null!==(t=null===D||void 0===D||null===(n=D.colorOption)||void 0===n?void 0:n[e])&&void 0!==t?t:e,color:"#00B8D9",isFixed:!0}})),Q=(0,u.useState)(!1),Y=(0,s.Z)(Q,2),K=Y[0],$=Y[1],q=(0,u.useState)(!1),H=(0,s.Z)(q,2),ee=H[0],te=H[1],ne=(0,u.useState)(null),ae=(0,s.Z)(ne,2),ie=ae[0],re=ae[1],oe=(0,u.useState)(""),se=(0,s.Z)(oe,2),ue=se[0],ce=se[1],le=(0,u.useState)(""),de=(0,s.Z)(le,2),fe=de[0],ve=de[1],pe=(0,u.useState)([]),he=(0,s.Z)(pe,2),me=he[0],xe=he[1],Ze=(0,u.useState)(null),ge=(0,s.Z)(Ze,2),ye=ge[0],ke=ge[1],Se=(0,u.useState)(""),be=(0,s.Z)(Se,2),De=be[0],je=be[1],we=(0,u.useState)(!1),Ae=(0,s.Z)(we,2),Ie=Ae[0],Ce=Ae[1],Pe=(0,u.useState)(null),Le=(0,s.Z)(Pe,2),Fe=Le[0],Ee=Le[1],Oe=(0,u.useState)(!1),Ne=(0,s.Z)(Oe,2),Be=Ne[0],_e=Ne[1],ze=(0,u.useState)(!1),Me=(0,s.Z)(ze,2),Te=Me[0],Re=Me[1],Ge=(0,u.useState)(!1),Je=(0,s.Z)(Ge,2),Ue=Je[0],Ve=Je[1],We=(0,u.useState)([]),Xe=(0,s.Z)(We,2),Qe=Xe[0],Ye=Xe[1],Ke=(0,u.useState)(!1),$e=(0,s.Z)(Ke,2),qe=$e[0],He=$e[1],et=(0,u.useState)(),tt=(0,s.Z)(et,2),nt=tt[0],at=tt[1],it=(0,u.useState)([]),rt=(0,s.Z)(it,2),ot=rt[0],st=rt[1],ut=(0,u.useState)(""),ct=(0,s.Z)(ut,2),lt=ct[0],dt=ct[1],ft=(0,u.useState)(!1),vt=(0,s.Z)(ft,2),pt=vt[0],ht=vt[1],mt=(0,u.useState)(""),xt=(0,s.Z)(mt,2),Zt=xt[0],gt=xt[1],yt=(0,u.useState)(!1),kt=(0,s.Z)(yt,2),St=kt[0],bt=kt[1],Dt=(0,u.useState)(!0),jt=(0,s.Z)(Dt,2),wt=jt[0],At=jt[1],It=(0,u.useState)(!1),Ct=(0,s.Z)(It,2),Pt=Ct[0],Lt=Ct[1],Ft=(0,u.useState)(),Et=(0,s.Z)(Ft,2),Ot=Et[0],Nt=Et[1],Bt=(0,u.useState)([{value:"Add Nominee",label:"Add Nominee",color:"#00B8D9",isFixed:!1}]),_t=(0,s.Z)(Bt,2),zt=_t[0],Mt=_t[1];(0,u.useEffect)((function(){!O&&E(),z()}),[]),(0,u.useEffect)((function(){_&&(0,P.Vh)(M,Rt,nn,re,$,xe,_)}),[_]),(0,u.useEffect)((function(){var t,n;if(null!==(t=e.dataList)&&void 0!==t&&null!==(n=t.data)&&void 0!==n&&n.length){var a=[{value:"Add Nominee",label:"Add Nominee",color:"#00B8D9",isFixed:!1}];e.dataList.data.forEach((function(e){var t={value:e._id,label:"".concat(e.name," - ").concat(e.relation),color:"#00B8D9",isFixed:!1};a.push(t)})),Mt(a)}}),[e.dataList]),(0,u.useEffect)((function(){T&&(Gt(),j.A9),R&&(j.A9,null===R||void 0===R||R.length)}),[T,R]);var Tt=function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{G(t)}catch(n){console.log("error",n)}case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();(0,u.useEffect)((function(){e.mediaData&&(Nt(e.mediaData),Re(!1))}),[e.mediaData]);var Rt=function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,Ve(!0),Re(!0),e.next=5,J(t);case 5:e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(0),Gt(),e.abrupt("return",(0,B.jsx)(j.A9,{handleClick:function(){},openSnack:!0,openSnackMsg:"Something went wrong",severity:"warning"}));case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),Gt=function(){He(!qe)},Jt=function(e,t){var n,a;"File"===e.type&&at(null===(a=t.target)||void 0===a?void 0:a.files[0]);var i=null!==(n=t.target.value)&&void 0!==n?n:"",r=ot,o=ot.findIndex((function(t){return t.key===e.key}));i.length<250&&(r[o].val=i,st(r),te(!ee),Ut())},Ut=function(){var e=!1;ot.forEach((function(t){t.mandatory&&!t.val.trim()&&(e=!0)})),At(e)},Vt=function(){var t=(0,o.Z)((0,r.Z)().mark((function t(n){var a,i,o;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(lt&&!nt&&ot.forEach((function(e){"Attachments"===e.key&&(e.val="")})),a={assetType:De,assetDetails:(0,w.OQ)(ot),nominees:Qe,id:Zt},!((i=_.findIndex((function(e){return e.id===Zt})))>=0)){t.next=8;break}_.splice(i,1),_.push(a),t.next=9;break;case 8:return t.abrupt("return");case 9:return o=[],Qe.forEach((function(e){e.objectid=Zt})),ye.nominees.forEach((function(e){-1===Qe.findIndex((function(t){return t.id===e.id}))&&(e.objectid=Zt,o.push(e))})),t.t0=b(),t.t1=null===W||void 0===W?void 0:W._id,t.next=16,(0,L.Gf)(JSON.stringify(_));case 16:t.t2=t.sent,t.t3=Qe,t.t4=o,t.t5={_id:t.t1,assets:t.t2,nominees:t.t3,deletednominee:t.t4},t.t6={headers:{Authorization:"Bearer ".concat(sessionStorage.getItem("authtoken"))}},t.t0.post.call(t.t0,"/backendapi/asset/adddetails",t.t5,t.t6).then((function(t){lt&&Tt(lt),j.A9,e.getData(e.parsedFilter),z(),Lt(!1)})).catch((function(){Lt(!1)})),en(),tn(),At(!0);case 25:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Wt=function(e){Lt(!0),e.preventDefault(),ht(!1);var t=ot.findIndex((function(e){return"File"===e.type}));t>=0&&nt?""!==ot[t].val?Qt(nt).then(function(){var n=(0,o.Z)((0,r.Z)().mark((function n(a){var i;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,L.Y)(a.data.alias);case 2:i=n.sent,ot[t].val="".concat(i,"#~#").concat(a.data._id,"#~#").concat(a.data.attachment[0]),st(ot),Vt(e);case 6:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()).catch((function(e){var t,n;Lt(!1),(null===e||void 0===e||null===(t=e.response)||void 0===t?void 0:t.data)&&(j.A9,null===e||void 0===e||null===(n=e.response)||void 0===n||n.data)})):Vt(e):Vt(e)},Xt=function(e){return new Promise((function(t,n){var a=new FileReader;a.readAsDataURL(e),a.onload=function(){return t(a.result)},a.onerror=function(e){return n(e)}}))},Qt=function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t){var n,a,i,o,s,u;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],(a={}).user=null===W||void 0===W?void 0:W._id,a.type="Asset",e.next=6,(0,L.Gf)(t.name);case 6:return a.alias=e.sent,e.next=9,Xt(t);case 9:return i=e.sent,e.next=12,(0,L.Gf)(i);case 12:return o=e.sent,s=d().compressToUTF16(o),n.push({media:s,name:t.name,type:t.type,user:null===W||void 0===W?void 0:W._id}),a.attachment=n,e.next=18,b().post("/backendapi/document/add",a,{headers:{Authorization:"Bearer ".concat(sessionStorage.getItem("authtoken"))}});case 18:return u=e.sent,e.abrupt("return",u);case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Yt=function(){var t=(0,o.Z)((0,r.Z)().mark((function t(){var n;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={assetType:De,assetDetails:(0,w.OQ)(ot),nominees:Qe,id:(0,c.Z)()},Qe.forEach((function(e){e.objectid=n.id})),_.push(n),t.t0=b(),t.t1=null===W||void 0===W?void 0:W._id,t.next=7,(0,L.Gf)(JSON.stringify(_));case 7:t.t2=t.sent,t.t3=Qe,t.t4={_id:t.t1,assets:t.t2,nominees:t.t3},t.t5={headers:{Authorization:"Bearer ".concat(sessionStorage.getItem("authtoken"))}},t.t0.post.call(t.t0,"/backendapi/asset/adddetails",t.t4,t.t5).then((function(t){return en(),e.getData(e.parsedFilter),z(),tn(),At(!0),Lt(!1),(0,B.jsx)(j.A9,{handleClick:function(){},openSnack:!0,openSnackMsg:"Asset added successfully!"})})).catch((function(){Lt(!1)}));case 12:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Kt=function(e){Lt(!0),e.preventDefault();var t=ot.findIndex((function(e){return"File"===e.type}));t>=0?""!==ot[t].val?Qt(nt).then(function(){var e=(0,o.Z)((0,r.Z)().mark((function e(n){var a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,L.Y)(n.data.alias);case 2:a=e.sent,ot[t].val="".concat(a,"#~#").concat(n.data._id,"#~#").concat(n.data.attachment[0]),st(ot),Yt();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){var t,n;Lt(!1),(null===e||void 0===e||null===(t=e.response)||void 0===t?void 0:t.data)&&(j.A9,null===e||void 0===e||null===(n=e.response)||void 0===n||n.data)})):Yt():Yt()},$t=function(){var t=(0,o.Z)((0,r.Z)().mark((function t(n){var a,i;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=_.findIndex((function(e){return e.id===n})),i=[],!(a>=0)){t.next=9;break}_[a].assetDetails.filter((function(e){return"File"===e.type})).forEach((function(e){var t=e.val.split("#~#");null!==t&&void 0!==t&&t[1]&&b().delete("/backendapi/document/deletebyid/".concat(t[1]),{headers:{Authorization:"Bearer ".concat(sessionStorage.getItem("authtoken"))}})})),_[a].nominees.forEach((function(e){e.objectid=_[a].id,i.push(e)})),_.splice(a,1),t.next=10;break;case 9:return t.abrupt("return");case 10:return t.t0=b(),t.t1=null===W||void 0===W?void 0:W._id,t.next=14,(0,L.Gf)(JSON.stringify(_));case 14:t.t2=t.sent,t.t3=i,t.t4={_id:t.t1,assets:t.t2,deletednominee:t.t3},t.t5={headers:{Authorization:"Bearer ".concat(sessionStorage.getItem("authtoken"))}},t.t0.post.call(t.t0,"/backendapi/asset/adddetails",t.t4,t.t5).then((function(t){return e.getData(e.parsedFilter),z(),(0,B.jsx)(j.A9,{handleClick:function(){},openSnack:!0,openSnackMsg:"Deleted successfully!",severity:"warning"})})).catch(),en(),tn(),At(!0);case 22:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),qt=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Ce(e),!0===t&&(Ee(null),bt(!0))},Ht=function(){var t=(0,o.Z)((0,r.Z)().mark((function t(n){return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.addData(n);case 3:_e(!1),qt(!1,!0),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),_e(!1),j.A9;case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}(),en=function(){_&&(0,P.Vh)(e.dataList,Rt,nn,re,$,xe,_),je(""),dt(""),st([]),at(""),Ye([]),pt&&At(!0)},tn=function(){ce(""),ve(""),S.current&&S.current.select.clearValue()},nn=function(e){At(!0);var t=e.assetDetails,n=e.assetType,a=e.nominees;je(n),ht(!0),gt(e.id),ke(e),st(t),Ye((0,i.Z)(a))},an=function(){var e="";return X.forEach((function(t){t.value===De&&(e=t)})),e};return(0,B.jsxs)(f.Z,{children:[(0,B.jsx)(P.zV,{prviewmodal:Ue,setprviewmodal:Ve,loading:Te,blobUrl:Ot,reset:function(){return U()}}),(0,B.jsx)(g.Z,{handleConfirm:function(){$t(ie),$(!1)},isOpen:K,closeModal:function(){return $(!1)}}),(0,B.jsx)(C.Z,{show:Ie,data:Fe,updateData:e.updateData,addData:Ht,isLoading:Be,handleSidebar:qt,getData:E,dataParams:N,addNew:St}),(0,B.jsxs)(v.ZP,{container:!0,spacing:2,sx:{p:2},children:[(0,B.jsx)(v.ZP,{item:!0,xs:12,md:9,lg:9,children:(0,B.jsx)(p.Z,{children:(0,B.jsxs)(h.Z,{children:[(0,B.jsx)(j.ll,{title:pt?"Edit Asset":"Add New Asset"}),(0,B.jsxs)(v.ZP,{rowSpacing:.01,container:!0,spacing:1,children:[(0,B.jsx)(v.ZP,{item:!0,xs:12,sm:6,children:(0,B.jsx)(A.gc,{id:"assetID",name:"assetID",isDisabled:pt,options:X,onChange:function(e,t){return function(e){At(!0),(0,w.L9)(),ce(""),ve(""),Ye([]),at(""),je(null===e||void 0===e?void 0:e.value),st(e?V[e.value]:{})}(t)},value:an().value,renderInput:function(e){var t;return(0,B.jsx)(Z.Z,(0,a.Z)((0,a.Z)({},e),{},{placeholder:pt?an().value:null!==(t=null===D||void 0===D?void 0:D.assetOptionText)&&void 0!==t?t:"Asset Type"}))}})}),(0,B.jsx)(v.ZP,{item:!0,xs:12,sm:6,children:(0,B.jsx)(A.gc,{isMulti:!0,name:"nominee",id:"nomineeId",onChange:function(e,t){return function(e){pt&&At(!1);var t=[];(null===e||void 0===e?void 0:e.length)&&e.forEach((function(e){"Add Nominee"===e.value?Ce(!0):t.push({id:e.value,name:e.label,objectid:Zt})})),Ye([].concat(t))}(t)},options:null===zt||void 0===zt?void 0:zt.filter((function(e){return!Qe.some((function(t){return t.id===e.value}))})),value:Qe.map((function(e){var t=zt.filter((function(t){return t.value===e.id}));return{value:t[0].value,label:t[0].label}})),renderInput:function(e){var t;return(0,B.jsx)(Z.Z,(0,a.Z)((0,a.Z)({},e),{},{placeholder:null!==(t=null===D||void 0===D?void 0:D.nomineeOption)&&void 0!==t?t:"Nominee(s)"}))}})}),Object.keys(V).includes(De)&&ot.map((function(e,t){return(0,B.jsx)(v.ZP,{item:!0,xs:12,sm:6,children:"Attachments"!==e.key?(0,B.jsxs)(B.Fragment,{children:[e.deletable&&(0,B.jsx)(I.Z,{size:15,onClick:function(){return function(e){pt&&At(!1);var t=ot.filter((function(t){return e.key!==t.key}));st(t)}(e)}}),(0,B.jsx)(Z.Z,{type:e.type,onKeyPress:function(t){"number"===e.type.toLowerCase()&&((0,F.ZP)(t),function(e){var t=(null===e||void 0===e?void 0:e.keyCode)||(null===e||void 0===e?void 0:e.which),n=document.getElementById("assetSubmit");13===t&&(!n||n.disabled||Pt||(pt?Wt(e):Kt(e)))}(t))},name:"city",id:"cityMulti",max:"9999-12-31",min:"1900-01-01",rows:"1",placeholder:e.key,value:e.val,onChange:function(t){Jt(e,t)}})]}):pt&&!lt&&e.val.split("#~#")[1]?(0,B.jsxs)("div",{children:[(0,B.jsx)(I.Z,{style:{position:"absolute",right:"-5px",top:"-7px"},size:15,onClick:function(){dt(e.val.split("#~#")[1])}}),(0,B.jsx)("span",{style:{color:"blue",cursor:"pointer"},onClick:function(){Rt(e.val.split("#~#")[2])},children:e.val.split("#~#")[0]})]}):(0,B.jsx)(Z.Z,{type:e.type,size:"small",fullWidth:!0,id:"fileAtt",value:null,onChange:function(t){Jt(e,t)},placeholder:""})},t)}))]}),(0,B.jsxs)(m.Z,{direction:"row",spacing:3,sx:{mt:3},justifyContent:"end",children:[De&&(0,B.jsx)(x.Z,{onClick:Gt,children:"Add Custom Field"}),(0,B.jsx)(A.ZP,{varient:"outlined",label:pt?"Cancel":null!==(t=null===D||void 0===D?void 0:D.resetButton)&&void 0!==t?t:"Reset",onClick:function(e){ht(!1),en()}}),(0,B.jsx)(A.ZP,{varient:"contained",isLoading:Pt,label:pt?"Update":null!==(n=null===D||void 0===D?void 0:D.submitButton)&&void 0!==n?n:"Add",disabled:!lt&&(0===Qe.length||!De||wt||Pt),onClick:function(e){pt?Wt(e):Kt(e)}})]})]})})}),(0,B.jsx)(y.Z,{}),(0,B.jsx)(v.ZP,{item:!0,xs:12,md:9,lg:9,children:(0,B.jsx)(k.ZP,{heading:null!==(l=null===D||void 0===D?void 0:D.textList)&&void 0!==l?l:"Assets List",isLoading:e.listLoading,collapseItems:me,colorOption:null===D||void 0===D?void 0:D.colorOption1})})]}),(0,B.jsx)(P.Id,{modal:qe,fname:ue,ftype:fe,loading:Te,addfield:function(e){e.preventDefault();var t=ot,n=t.length,a="";if(t.findIndex((function(e){return e.key===ue}))>=0)return(0,B.jsx)(j.A9,{handleClick:function(){},openSnack:!0,openSnackMsg:"Field Already Exist! Please add new field",severity:"error"});"Attachments"===t[n-1].key?(a=t[n-1],t[n-1]={key:ue,val:"",type:fe,deletable:!0},t.push(a),st(t),ce(""),ve("")):(t.push({key:ue+fe,val:"",type:fe,deletable:!0}),st(t),ce(""),ve("")),Gt()},messages:D,setfname:ce,setftype:ve,assetType:De,toggleModal:Gt,selectCustomRef:S,clearCustomField:tn})]})}))}}]);