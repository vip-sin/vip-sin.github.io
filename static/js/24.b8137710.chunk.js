"use strict";(self.webpackChunkvpn=self.webpackChunkvpn||[]).push([[24],{48934:function(e,t,n){n.r(t);var a=n(1413),i=n(93433),o=n(74165),s=n(15861),l=n(29439),d=n(47313),r=n(95162),u=n(64162),c=n.n(u),v=n(40229),f=n(71535),p=n(96900),h=n(56972),m=n(62463),g=n(89870),x=n(39653),Z=n(96327),y=n(39995),k=n(31881),S=n.n(k),A=n(66135),b=n(61474),j=n(35192),D=n(63861),I=n(10226),w=n(62457),C=n(86240),L=n(50850),F=n(97729),P=n(54727),O=n(36936),E=n(30879),B=n(46417);t.default=(0,A.$j)((function(e){var t,n,a=e.reducer.customizer,i=void 0===a?{}:a,o=e.reducer.dataList;return{dataList:o,messages:null===i||void 0===i||null===(t=i.language)||void 0===t?void 0:t.Asset,assetListFromAPI:null!==(n=null===o||void 0===o?void 0:o.assetListFromAPI)&&void 0!==n?n:[],listLoading:null===o||void 0===o?void 0:o.totalRecordsLoading}}),(function(e){return{getData:function(t){return e(O.SD.endpoints.getData.initiate(t))},addData:function(t){return e(O.SD.endpoints.addAssetData.initiate(t))},callAssetAPI:function(t){return e(E.aN.endpoints.getAssetData.initiate(t))}}}))((function(e){var t,n,u,k=(0,d.createRef)(),A=e.messages,O=e.getData,E=e.listLoading,N=e.parsedFilter,z=e.assetListFromAPI,_=e.callAssetAPI,T=e.dataList,U=JSON.parse(sessionStorage.getItem("dropdowns")).assetOption,M=Object.keys(U).map((function(e){var t,n;return{value:e,label:null!==(t=null===A||void 0===A||null===(n=A.colorOption)||void 0===n?void 0:n[e])&&void 0!==t?t:e,color:"#00B8D9",isFixed:!0}})),R=(0,d.useState)(""),G=(0,l.Z)(R,2),J=G[0],V=G[1],Y=(0,d.useState)(null),Q=(0,l.Z)(Y,2),H=Q[0],K=Q[1],W=(0,d.useState)(!1),$=(0,l.Z)(W,2),q=$[0],X=$[1],ee=(0,d.useState)(!1),te=(0,l.Z)(ee,2),ne=te[0],ae=te[1],ie=(0,d.useState)(!1),oe=(0,l.Z)(ie,2),se=oe[0],le=oe[1],de=(0,d.useState)(null),re=(0,l.Z)(de,2),ue=re[0],ce=re[1],ve=(0,d.useState)(""),fe=(0,l.Z)(ve,2),pe=fe[0],he=fe[1],me=(0,d.useState)(""),ge=(0,l.Z)(me,2),xe=ge[0],Ze=ge[1],ye=(0,d.useState)([]),ke=(0,l.Z)(ye,2),Se=ke[0],Ae=ke[1],be=(0,d.useState)(""),je=(0,l.Z)(be,2),De=je[0],Ie=je[1],we=(0,d.useState)(""),Ce=(0,l.Z)(we,2),Le=Ce[0],Fe=Ce[1],Pe=(0,d.useState)(""),Oe=(0,l.Z)(Pe,2),Ee=Oe[0],Be=Oe[1],Ne=(0,d.useState)(!1),ze=(0,l.Z)(Ne,2),_e=ze[0],Te=ze[1],Ue=(0,d.useState)(null),Me=(0,l.Z)(Ue,2),Re=Me[0],Ge=Me[1],Je=(0,d.useState)(!1),Ve=(0,l.Z)(Je,2),Ye=Ve[0],Qe=Ve[1],He=(0,d.useState)(!1),Ke=(0,l.Z)(He,2),We=Ke[0],$e=Ke[1],qe=(0,d.useState)(!1),Xe=(0,l.Z)(qe,2),et=Xe[0],tt=Xe[1],nt=(0,d.useState)([]),at=(0,l.Z)(nt,2),it=at[0],ot=at[1],st=(0,d.useState)(!1),lt=(0,l.Z)(st,2),dt=lt[0],rt=lt[1],ut=(0,d.useState)(),ct=(0,l.Z)(ut,2),vt=ct[0],ft=ct[1],pt=(0,d.useState)([]),ht=(0,l.Z)(pt,2),mt=ht[0],gt=ht[1],xt=(0,d.useState)(!0),Zt=(0,l.Z)(xt,2),yt=Zt[0],kt=Zt[1],St=(0,d.useState)(!1),At=(0,l.Z)(St,2),bt=At[0],jt=At[1],Dt=(0,d.useState)(),It=(0,l.Z)(Dt,2),wt=It[0],Ct=It[1],Lt=(0,d.useState)([{value:"Add Nominee",label:"Add Nominee",color:"#00B8D9",isFixed:!1}]),Ft=(0,l.Z)(Lt,2),Pt=Ft[0],Ot=Ft[1],Et=JSON.parse(sessionStorage.getItem("logInUserData"));(0,d.useEffect)((function(){!E&&O(),_()}),[]),(0,d.useEffect)((function(){z&&(0,L.Vh)(T,Nt,Wt,ce,le,Ae,z)}),[z]),(0,d.useEffect)((function(){var t,n;if(null!==(t=e.dataList)&&void 0!==t&&null!==(n=t.data)&&void 0!==n&&n.length){var a=[{value:"Add Nominee",label:"Add Nominee",color:"#00B8D9",isFixed:!1}];e.dataList.data.forEach((function(e){var t={value:e._id,label:"".concat(e.name," - ").concat(e.relation),color:"#00B8D9",isFixed:!1};a.push(t)})),Ot(a)}}),[e.dataList]);var Bt=sessionStorage.getItem("authtoken"),Nt=function(e){tt(!0),$e(!0),S().get("/backendapi/sender/msg/".concat(e),{headers:{Authorization:"Bearer ".concat(Bt)}}).then((function(e){var t,n=null===(t=e.data[0])||void 0===t?void 0:t.media,a=c().decompressFromUTF16(n),i=(0,F.Y)(a);if(!i)return tt(!et),(0,B.jsx)(D.A9,{handleClick:function(){},openSnack:!0,openSnackMsg:"Something went wrong",severity:"warning"});for(var o,s=atob(null===i||void 0===i?void 0:i.split("base64,")[1]),l=new Array(s.length),d=0;d<s.length;d++)l[d]=s.charCodeAt(d);var r=new Uint8Array(l),u=new Blob([r],{type:null===(o=e.data[0])||void 0===o?void 0:o.type}),v=URL.createObjectURL(u);Ct(v),$e(!1)}))},zt=function(){rt(!dt)},_t=function(e,t){var n,a;"File"===e.type&&ft(null===(a=t.target)||void 0===a?void 0:a.files[0]);var i=null!==(n=t.target.value)&&void 0!==n?n:"",o=mt,s=mt.findIndex((function(t){return t.key===e.key}));i.length<250&&(o[s].val=i,gt(o),X(!q),Tt())},Tt=function(){var e=!1;mt.forEach((function(t){t.mandatory&&!t.val.trim()&&(e=!0)})),kt(e)},Ut=function(t){Le&&!vt&&mt.forEach((function(e){"Attachments"===e.key&&(e.val="")}));var n={assetType:Ee,assetDetails:(0,C.OQ)(mt),nominees:it,id:J},a=z.findIndex((function(e){return e.id===J}));if(a>=0){z.splice(a,1),z.push(n);var i=[];it.forEach((function(e){e.objectid=J})),H.nominees.forEach((function(e){-1===it.findIndex((function(t){return t.id===e.id}))&&(e.objectid=J,i.push(e))})),S().post("/backendapi/adddetails",{_id:null===Et||void 0===Et?void 0:Et._id,assets:(0,F.G)(JSON.stringify(z)),nominees:it,deletednominee:i},{headers:{Authorization:"Bearer ".concat(sessionStorage.getItem("authtoken"))}}).then((function(t){var n;Le&&(n=Le,S().delete("/backendapi/document/deletebyid/".concat(n),{headers:{Authorization:"Bearer ".concat(Bt)}}).then((function(e){D.A9}))),D.A9,e.getData(e.parsedFilter),_(),jt(!1)})).catch((function(){jt(!1)})),Ht(),Kt(),kt(!0)}},Mt=function(e){jt(!0),e.preventDefault(),Ie(!1);var t=mt.findIndex((function(e){return"File"===e.type}));t>=0&&vt?""!==mt[t].val?Gt(vt).then((function(e){mt[t].val="".concat((0,F.Y)(e.data.alias),"#~#").concat(e.data._id,"#~#").concat(e.data.attachment[0]),gt(mt),Ut()})).catch((function(e){var t,n;jt(!1),(null===e||void 0===e||null===(t=e.response)||void 0===t?void 0:t.data)&&(D.A9,null===e||void 0===e||null===(n=e.response)||void 0===n||n.data)})):Ut():Ut()},Rt=function(e){return new Promise((function(t,n){var a=new FileReader;a.readAsDataURL(e),a.onload=function(){return t(a.result)},a.onerror=function(e){return n(e)}}))},Gt=function(){var e=(0,s.Z)((0,o.Z)().mark((function e(t){var n,a,i,s,l,d;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],(a={}).user=null===Et||void 0===Et?void 0:Et._id,a.type="Asset",a.alias=(0,F.G)(t.name),e.next=7,Rt(t);case 7:return i=e.sent,s=(0,F.G)(i),l=c().compressToUTF16(s),n.push({media:l,name:t.name,type:t.type,user:null===Et||void 0===Et?void 0:Et._id}),a.attachment=n,e.next=14,S().post("/backendapi/documents/add",a,{headers:{Authorization:"Bearer ".concat(sessionStorage.getItem("authtoken"))}});case 14:return d=e.sent,e.abrupt("return",d);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Jt=function(e){jt(!0),e.preventDefault();var t=mt.findIndex((function(e){return"File"===e.type}));t>=0?""!==mt[t].val?Gt(vt).then((function(e){mt[t].val="".concat((0,F.Y)(e.data.alias),"#~#").concat(e.data._id,"#~#").concat(e.data.attachment[0]),gt(mt),Vt()})).catch((function(e){var t,n;jt(!1),(null===e||void 0===e||null===(t=e.response)||void 0===t?void 0:t.data)&&(D.A9,null===e||void 0===e||null===(n=e.response)||void 0===n||n.data)})):Vt():Vt()},Vt=function(){var t={assetType:Ee,assetDetails:(0,C.OQ)(mt),nominees:it,id:(0,r.Z)()};it.forEach((function(e){e.objectid=t.id})),z.push(t),S().post("/backendapi/adddetails",{_id:null===Et||void 0===Et?void 0:Et._id,assets:(0,F.G)(JSON.stringify(z)),nominees:it},{headers:{Authorization:"Bearer ".concat(sessionStorage.getItem("authtoken"))}}).then((function(t){return Ht(),e.getData(e.parsedFilter),_(),Kt(),kt(!0),jt(!1),(0,B.jsx)(D.A9,{handleClick:function(){},openSnack:!0,openSnackMsg:"Asset added successfully!"})})).catch((function(){jt(!1)}))},Yt=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Te(e),!0===t&&(Ge(null),ae(!0))},Qt=function(){var t=(0,s.Z)((0,o.Z)().mark((function t(n){return(0,o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.addData(n);case 3:Qe(!1),Yt(!1,!0),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),Qe(!1),D.A9;case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}(),Ht=function(){z&&(0,L.Vh)(e.dataList,Nt,Wt,ce,le,Ae,z),Be(""),Fe(""),gt([]),ft(""),ot([]),De&&kt(!0)},Kt=function(){he(""),Ze(""),k.current&&k.current.select.clearValue()},Wt=function(e){kt(!0);var t=e.assetDetails,n=e.assetType,a=e.nominees;Be(n),Ie(!0),V(e.id),K(e),gt(t),ot((0,i.Z)(a))},$t=function(){var e="";return M.forEach((function(t){t.value===Ee&&(e=t)})),e};return(0,B.jsxs)(v.Z,{children:[(0,B.jsx)(L.zV,{prviewmodal:et,setprviewmodal:tt,loading:We,blobUrl:wt}),(0,B.jsx)(Z.Z,{handleConfirm:function(){!function(t){var n=z.findIndex((function(e){return e.id===t})),a=[];n>=0&&(z[n].assetDetails.filter((function(e){return"File"===e.type})).forEach((function(e){var t=e.val.split("#~#");null!==t&&void 0!==t&&t[1]&&S().delete("/backendapi/document/deletebyid/".concat(t[1]),{headers:{Authorization:"Bearer ".concat(sessionStorage.getItem("authtoken"))}})})),z[n].nominees.forEach((function(e){e.objectid=z[n].id,a.push(e)})),z.splice(n,1),S().post("/backendapi/adddetails",{_id:null===Et||void 0===Et?void 0:Et._id,assets:(0,F.G)(JSON.stringify(z)),deletednominee:a},{headers:{Authorization:"Bearer ".concat(sessionStorage.getItem("authtoken"))}}).then((function(t){return e.getData(e.parsedFilter),_(),(0,B.jsx)(D.A9,{handleClick:function(){},openSnack:!0,openSnackMsg:"Deleted successfully!",severity:"warning"})})).catch(),Ht(),Kt(),kt(!0))}(ue),le(!1)},isOpen:se,closeModal:function(){return le(!1)}}),_e&&(0,B.jsx)(I.Z,{show:_e,data:Re,updateData:e.updateData,addData:Qt,isLoading:Ye,handleSidebar:Yt,getData:O,dataParams:N,addNew:ne}),(0,B.jsxs)(f.ZP,{container:!0,spacing:2,sx:{p:.5},children:[(0,B.jsx)(f.ZP,{item:!0,xs:12,sm:8,children:(0,B.jsxs)(p.Z,{children:[(0,B.jsx)(D.ll,{title:(null!==(t=null===A||void 0===A?void 0:A.subHeading)&&void 0!==t?t:De)?"Edit Asset Details":"Add New Asset"}),(0,B.jsxs)(h.Z,{children:[(0,B.jsxs)(f.ZP,{container:!0,spacing:1,children:[(0,B.jsx)(f.ZP,{item:!0,xs:12,sm:6,children:(0,B.jsx)(b.gc,{id:"assetID",name:"assetID",isDisabled:De,options:M,onChange:function(e,t){return function(e){kt(!0),(0,C.L9)(),he(""),Ze(""),ot([]),ft(""),Be(null===e||void 0===e?void 0:e.value),gt(e?U[e.value]:{})}(t)},value:$t().value,renderInput:function(e){var t;return(0,B.jsx)(x.Z,(0,a.Z)((0,a.Z)({},e),{},{placeholder:De?$t().value:null!==(t=null===A||void 0===A?void 0:A.assetOptionText)&&void 0!==t?t:"Asset Type"}))}})}),(0,B.jsx)(f.ZP,{item:!0,xs:12,sm:6,children:(0,B.jsx)(b.gc,{isMulti:!0,name:"nominee",id:"nomineeId",onChange:function(e,t){return function(e){De&&kt(!1);var t=[];(null===e||void 0===e?void 0:e.length)&&e.forEach((function(e){"Add Nominee"===e.value?Te(!0):t.push({id:e.value,name:e.label,objectid:J})})),ot([].concat(t))}(t)},options:Pt,value:it.map((function(e){var t=Pt.filter((function(t){return t.value===e.id}));return{value:t[0].value,label:t[0].label}})),renderInput:function(e){var t;return(0,B.jsx)(x.Z,(0,a.Z)((0,a.Z)({},e),{},{placeholder:null!==(t=null===A||void 0===A?void 0:A.nomineeOption)&&void 0!==t?t:"Nominee(s)"}))}})}),Object.keys(U).includes(Ee)&&mt.map((function(e,t){return(0,B.jsx)(f.ZP,{item:!0,xs:12,sm:6,children:"Attachments"!==e.key?(0,B.jsxs)(B.Fragment,{children:[e.deletable&&(0,B.jsx)(j.Z,{size:15,onClick:function(){!function(e){De&&kt(!1);var t=mt.filter((function(t){return e.key!==t.key}));gt(t)}(e)}}),(0,B.jsx)(x.Z,{type:e.type,onKeyPress:function(t){"number"===e.type.toLowerCase()&&((0,P.ZP)(t),function(e){var t=(null===e||void 0===e?void 0:e.keyCode)||(null===e||void 0===e?void 0:e.which),n=document.getElementById("assetSubmit");13===t&&(!n||n.disabled||bt||(De?Mt(e):Jt(e)))}(t))},name:"city",id:"cityMulti",max:"9999-12-31",min:"1900-01-01",rows:"1",placeholder:e.key,value:e.val,onChange:function(t){_t(e,t)}})]}):De&&!Le&&e.val.split("#~#")[1]?(0,B.jsx)(B.Fragment,{children:(0,B.jsxs)("div",{children:[(0,B.jsx)(j.Z,{style:{position:"absolute",right:"-5px",top:"-7px"},size:15,onClick:function(){Fe(e.val.split("#~#")[1])}}),(0,B.jsx)("span",{style:{color:"blue"},onClick:function(){Nt(e.val.split("#~#")[2])},children:e.val.split("#~#")[0]})]})}):(0,B.jsx)(x.Z,{type:e.type,size:"small",fullWidth:!0,id:"fileAtt",value:null,onChange:function(t){_t(e,t)}})},t)}))]}),(0,B.jsxs)(m.Z,{direction:"row",spacing:3,sx:{mt:3},justifyContent:"end",children:[Ee&&(0,B.jsx)(g.Z,{onClick:zt,children:"Add Custom Field"}),(0,B.jsx)(b.ZP,{varient:"outlined",label:De?"Cancel":null!==(n=null===A||void 0===A?void 0:A.resetButton)&&void 0!==n?n:"Reset",onClick:function(e){Ie(!1),Ht()}}),(0,B.jsx)(b.ZP,{varient:"contained",isLoading:bt,label:De?"Update":null!==(u=null===A||void 0===A?void 0:A.submitButton)&&void 0!==u?u:"Add",disabled:!Le&&(0===it.length||!Ee||yt||bt),onClick:function(e){De?Mt(e):Jt(e)}})]})]})]})}),(0,B.jsx)(y.Z,{}),(0,B.jsx)(f.ZP,{item:!0,xs:12,children:(0,B.jsx)(w.ZP,{heading:null!==A&&void 0!==A&&A.textList?null===A||void 0===A?void 0:A.textList:"Assets List",isLoading:e.listLoading,collapseItems:Se,colorOption:null===A||void 0===A?void 0:A.colorOption1})})]}),(0,B.jsx)(L.Id,{modal:dt,fname:pe,ftype:xe,loading:We,addfield:function(e){e.preventDefault();var t=mt,n=t.length,a="";if(t.findIndex((function(e){return e.key===pe}))>=0)return(0,B.jsx)(D.A9,{handleClick:function(){},openSnack:!0,openSnackMsg:"Field Already Exist! Please add new field",severity:"error"});"Attachments"===t[n-1].key?(a=t[n-1],t[n-1]={key:pe,val:"",type:xe,deletable:!0},t.push(a),gt(t),he(""),Ze("")):(t.push({key:pe+xe,val:"",type:xe,deletable:!0}),gt(t),he(""),Ze("")),zt()},messages:A,setfname:he,setftype:Ze,assetType:Ee,toggleModal:zt,selectCustomRef:k,clearCustomField:Kt})]})}))}}]);