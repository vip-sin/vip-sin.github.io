"use strict";(self.webpackChunkvpn=self.webpackChunkvpn||[]).push([[934],{32934:function(e,t,n){n.r(t),n.d(t,{default:function(){return G}});var i=n(1413),a=n(93433),l=n(74165),o=n(15861),s=n(29439),r=n(47313),c=n(95162),d=n(64162),u=n.n(d),v=n(49461),f=n.n(v),p=n(40229),h=n(7081),m=n(5448),x=n(71535),y=n(88356),g=n(96900),b=n(56972),Z=n(62463),j=n(89870),k=n(39653),S=n(31616),w=n(39995),A=n(62457),L=n(31881),P=n.n(L),D=n(66135),C=n(58470),N=n(86282),I=n(61474),F=n(35192),O=n(71363),z=n(71207),E=n(54727),B=n(46417),_=function(e,t,n,i,a,l,o){var s=[];(null===o||void 0===o?void 0:o.length)&&o.forEach((function(l,o){if(l.id){var r,c="";(null===l||void 0===l||null===(r=l.nominees)||void 0===r?void 0:r.length)&&l.nominees.forEach((function(t,n){var i=e.data.filter((function(e){return e._id===t.id}));i.length&&(n===l.nominees.length-1?c+=i[0].name:c="".concat(c+i[0].name,", "))}));var d=(0,B.jsx)("div",{children:(0,B.jsxs)(x.ZP,{container:!0,spacing:2,children:[l.liabilityDetails.map((function(e,n){if(""!==e.val){var i,a=e.val;if("File"===e.type){var l=e.val.split("#~#");a=(0,B.jsx)("u",{children:(0,B.jsx)("span",{style:{color:"blue"},onClick:function(){t(l[2])},children:l[0]})})}return(0,B.jsx)(x.ZP,{item:!0,sm:5,xs:12,children:(0,B.jsxs)(O.Z,{children:[(0,B.jsxs)("span",{className:"font-weight-bold upper-text ".concat(N.LP?"upper-text-dark":"upper-text"),children:[e.key&&(null===(i=e.key.split("*"))||void 0===i?void 0:i[0])," :"]})," ",(0,B.jsx)("span",{className:"".concat(N.LP?"lower-text-dark":"lower-text"),children:"Date"===e.type?(0,E.p6)(a):a})]})},n+e.key)}return""})),(0,B.jsx)(x.ZP,{item:!0,sm:5,sx:12,children:(0,B.jsxs)(O.Z,{children:[(0,B.jsx)("span",{className:"font-weight-bold upper-text ".concat(N.LP?"upper-text-dark":"upper-text"),children:"Nominees :"})," ",(0,B.jsx)("span",{className:"".concat(N.LP?"lower-text-dark":"lower-text"),children:c})]})}),(0,B.jsx)(x.ZP,{item:!0,sm:2,sx:12,children:(0,B.jsxs)(O.Z,{children:[(0,B.jsx)("b",{children:(0,B.jsx)(z.Z,{className:"cursor-pointer mr-1",size:window.screen.width<500?13:20,onClick:function(){n(l)}})}),(0,B.jsx)("b",{children:(0,B.jsx)(F.Z,{className:"cursor-pointer",size:window.screen.width<500?13:20,onClick:function(){i(l.id),a(!0)}})})]})})]})}),u={id:o+1,title:l.liabilityType,content:d};s.push(u)}})),l(null===s||void 0===s?void 0:s.reverse())},M=n(97729),T=n(10226),R=n(50850),U=n(23317),J=n(36936),G=(0,D.$j)((function(e){var t,n,i=e.reducer,a=i.dataList,l=i.customizer,o=void 0===l?{}:l;return{dataList:a,liabilityListFromAPI:null!==(t=null===a||void 0===a?void 0:a.liabilityListFromAPI)&&void 0!==t?t:[],messages:null===o||void 0===o||null===(n=o.language)||void 0===n?void 0:n.Liability,listLoading:null===a||void 0===a?void 0:a.totalRecordsLoading}}),(function(e){return{getData:function(t){return e(J.SD.endpoints.getData.initiate())},addLiabilityData:function(t){return e(U.sk.endpoints.addLiabilityData.initiate(t))},callLiabilityAPI:function(t){return e(U.sk.endpoints.getLiabilityData.initiate())}}}))((function(e){var t,n,d,v=e.messages,L=e.thumbView,D=e.getData,O=e.parsedFilter,z=e.callLiabilityAPI,U=e.liabilityListFromAPI,J=e.addLiabilityData,G=JSON.parse(sessionStorage.getItem("dropdowns")).liabilityOption,V=JSON.parse(sessionStorage.getItem("logInUserData")),W=Object.keys(G).map((function(e){var t,n;return{value:e,label:null!==(t=null===v||void 0===v||null===(n=v.colorOption)||void 0===n?void 0:n[e])&&void 0!==t?t:e,color:"#00B8D9",isFixed:!0}})),Y=(0,r.createRef)(),Q=(0,r.useState)(!1),$=(0,s.Z)(Q,2),q=$[0],H=$[1],K=(0,r.useState)(!1),X=(0,s.Z)(K,2),ee=X[0],te=X[1],ne=(0,r.useState)(null),ie=(0,s.Z)(ne,2),ae=ie[0],le=ie[1],oe=(0,r.useState)(""),se=(0,s.Z)(oe,2),re=se[0],ce=se[1],de=(0,r.useState)(""),ue=(0,s.Z)(de,2),ve=ue[0],fe=ue[1],pe=(0,r.useState)(!0),he=(0,s.Z)(pe,2),me=he[0],xe=he[1],ye=(0,r.useState)([]),ge=(0,s.Z)(ye,2),be=ge[0],Ze=ge[1],je=(0,r.useState)(""),ke=(0,s.Z)(je,2),Se=ke[0],we=ke[1],Ae=(0,r.useState)(!1),Le=(0,s.Z)(Ae,2),Pe=Le[0],De=Le[1],Ce=(0,r.useState)(!1),Ne=(0,s.Z)(Ce,2),Ie=Ne[0],Fe=Ne[1],Oe=(0,r.useState)(null),ze=(0,s.Z)(Oe,2),Ee=ze[0],Be=ze[1],_e=(0,r.useState)(!1),Me=(0,s.Z)(_e,2),Te=Me[0],Re=Me[1],Ue=(0,r.useState)(!1),Je=(0,s.Z)(Ue,2),Ge=Je[0],Ve=Je[1],We=(0,r.useState)(!1),Ye=(0,s.Z)(We,2),Qe=Ye[0],$e=Ye[1],qe=(0,r.useState)([]),He=(0,s.Z)(qe,2),Ke=He[0],Xe=He[1],et=(0,r.useState)(!1),tt=(0,s.Z)(et,2),nt=tt[0],it=tt[1],at=(0,r.useState)(),lt=(0,s.Z)(at,2),ot=lt[0],st=lt[1],rt=(0,r.useState)([]),ct=(0,s.Z)(rt,2),dt=ct[0],ut=ct[1],vt=(0,r.useState)(""),ft=(0,s.Z)(vt,2),pt=ft[0],ht=ft[1],mt=(0,r.useState)(!1),xt=(0,s.Z)(mt,2),yt=xt[0],gt=xt[1],bt=(0,r.useState)(""),Zt=(0,s.Z)(bt,2),jt=Zt[0],kt=Zt[1],St=(0,r.useState)(!0),wt=(0,s.Z)(St,2),At=wt[0],Lt=wt[1],Pt=(0,r.useState)(!1),Dt=(0,s.Z)(Pt,2),Ct=Dt[0],Nt=Dt[1],It=(0,r.useState)(),Ft=(0,s.Z)(It,2),Ot=Ft[0],zt=Ft[1],Et=(0,r.useState)([{value:"Add Nominee",label:"Add Nominee",color:"#00B8D9",isFixed:!1}]),Bt=(0,s.Z)(Et,2),_t=Bt[0],Mt=Bt[1];(0,r.useEffect)((function(){if(e.dataList.data.length){var t=[{value:"Add Nominee",label:"Add Nominee",color:"#00B8D9",isFixed:!1}];e.dataList.data.forEach((function(e){var n={value:e._id,label:"".concat(e.name," - ").concat(e.relation),color:"#00B8D9",isFixed:!1};t.push(n)})),Mt(t)}}),[e.dataList]),(0,r.useEffect)((function(){U&&_(e.dataList,Jt,en,le,H,Ze,U)}),[U]),(0,r.useEffect)((function(){!e.listLoading&&D(),z()}),[]);var Tt=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];De(e),!0===t&&(Be(null),Fe(!0))},Rt=function(){var t=(0,o.Z)((0,l.Z)().mark((function t(n){return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Re(!0),t.prev=1,t.next=4,e.addData(n);case 4:Re(!1),Tt(!1,!0),t.next=12;break;case 8:return t.prev=8,t.t0=t.catch(1),Re(!1),t.abrupt("return",(0,B.jsx)(C.A9,{handleClick:function(){},openSnack:!0,openSnackMsg:"Add Nominee Failed! Please contact admin",severity:"error"}));case 12:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(e){return t.apply(this,arguments)}}(),Ut=sessionStorage.getItem("authtoken"),Jt=function(e){$e(!0),Ve(!0);var t=sessionStorage.getItem("authtoken");P().get("/backendapi/sender/msg/".concat(e),{headers:{Authorization:"Bearer ".concat(t)}}).then((function(e){var t,n=null===(t=e.data[0])||void 0===t?void 0:t.media,i=u().decompressFromUTF16(n),a=(0,M.Y)(i);if(!a)return $e(!Qe),(0,B.jsx)(C.A9,{handleClick:function(){},openSnack:!0,openSnackMsg:"Something went wrong",severity:"warning"});for(var l,o=atob(null===a||void 0===a?void 0:a.split("base64,")[1]),s=new Array(o.length),r=0;r<o.length;r++)s[r]=o.charCodeAt(r);var c=new Uint8Array(s),d=new Blob([c],{type:null===(l=e.data[0])||void 0===l?void 0:l.type}),v=URL.createObjectURL(d);zt(v),Ve(!1)}))},Gt=function(){it(!nt)},Vt=function(e,t,n){var i;"File"===t.type&&st(null===(i=n.target)||void 0===i?void 0:i.files[0]);var a=dt,l=a.findIndex((function(e){return e.key===t.key}));e.length<50&&(a[l].val=e,ut(a),function(){var e=!1;dt.forEach((function(t){t.mandatory&&!t.val.trim()&&(e=!0)})),Lt(e)}(),te(!ee))},Wt=function(e){return new Promise((function(t,n){var i=new FileReader;i.readAsDataURL(e),i.onload=function(){return t(i.result)},i.onerror=function(e){return n(e)}}))},Yt=function(){var e=(0,o.Z)((0,l.Z)().mark((function e(t){var n,i,a,o,s,r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],(i={}).user=null===V||void 0===V?void 0:V._id,i.type="Liability",i.alias=(0,M.G)(t.name),e.next=7,Wt(t);case 7:return a=e.sent,o=(0,M.G)(a),s=u().compressToUTF16(o),n.push({media:s,name:t.name,type:t.type,user:null===V||void 0===V?void 0:V._id}),i.attachment=n,e.next=14,P().post("/backendapi/documents/add",i,{headers:{Authorization:"Bearer ".concat(sessionStorage.getItem("authtoken"))}});case 14:return r=e.sent,e.abrupt("return",r);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Qt=function(t){Nt(!0),t.preventDefault(),pt&&!ot&&dt.forEach((function(e){"Attachments"===e.key&&(e.val="")}));var n={liabilityType:Se,liabilityDetails:(0,N.OQ)(dt),nominees:Ke,id:jt},i=U.findIndex((function(e){return e.id===jt}));i>=0&&(U.splice(i,1),U.push(n),P().post("/backendapi/adddetails",{_id:null===V||void 0===V?void 0:V._id,liabilities:(0,M.G)(JSON.stringify(U)),nominees:Ke},{headers:{Authorization:"Bearer ".concat(sessionStorage.getItem("authtoken"))}}).then((function(t){var n;return pt&&(n=pt,P().delete("/backendapi/document/deletebyid/".concat(n),{headers:{Authorization:"Bearer ".concat(Ut)}}).then((function(e){return(0,B.jsx)(C.A9,{handleClick:function(){},openSnack:!0,openSnackMsg:pt&&ot?"Attachment Replaced Successfully":"Attachment removed Successfully"})})).catch((function(e){console.log("err",e)})).finally((function(){Kt(),Xt(),Lt(!0)}))),D(e.parsedFilter),z(),Nt(!1),(0,B.jsx)(C.A9,{handleClick:function(){},openSnack:!0,openSnackMsg:"Updated successfully!"})})).catch((function(){Nt(!1)})),Kt(),Xt(),Lt(!0))},$t=function(e){Nt(!0),e.preventDefault(),gt(!1);var t=dt.findIndex((function(e){return"File"===e.type}));t>=0&&ot?""!==dt[t].val?Yt(ot).then((function(n){dt[t].val="".concat((0,M.Y)(n.data.alias),"#~#").concat(n.data._id,"#~#").concat(n.data.attachment[0]),ut(dt),Qt(e)})).catch((function(e){var t,n;Nt(!1),(null===e||void 0===e||null===(t=e.response)||void 0===t?void 0:t.data)&&(C.A9,null===e||void 0===e||null===(n=e.response)||void 0===n||n.data)})):Qt(e):Qt(e)},qt=function(){var t={liabilityType:Se,liabilityDetails:(0,N.OQ)(dt),nominees:Ke,id:(0,c.Z)()};return Ke.forEach((function(e){e.objectid=t.id})),U.push(t),P().post("/backendapi/adddetails",{_id:null===V||void 0===V?void 0:V._id,liabilities:(0,M.G)(JSON.stringify(U)),nominees:Ke},{headers:{Authorization:"Bearer ".concat(sessionStorage.getItem("authtoken"))}}).then((function(t){D(e.parsedFilter),z(),Nt(!1)})).catch((function(){Nt(!1)})),Kt(),Xt(),Lt(!0),(0,B.jsx)(C.A9,{handleClick:function(){},openSnack:!0,openSnackMsg:"Liability addedd successfully!"})},Ht=function(e){Nt(!0),e.preventDefault();var t=dt.findIndex((function(e){return"File"===e.type}));t>=0?""!==dt[t].val?Yt(ot).then((function(e){dt[t].val="".concat((0,M.Y)(e.data.alias),"#~#").concat(e.data._id,"#~#").concat(e.data.attachment[0]),ut(dt),qt()})).catch((function(e){var t,n;Nt(!1),(null===e||void 0===e||null===(t=e.response)||void 0===t?void 0:t.data)&&(C.A9,null===e||void 0===e||null===(n=e.response)||void 0===n||n.data)})):qt():qt()},Kt=function(){U&&_(e.dataList,Jt,en,le,H,Ze,U),we(""),ht(""),st(""),ut([]),Xe([]),yt&&Lt(!0)},Xt=function(){ce(""),fe(""),Y.current&&Y.current.select.clearValue()},en=function(e){var t=e.liabilityDetails,n=e.liabilityType,i=e.nominees;we(n),gt(!0),kt(e.id),ut(t),Xe((0,a.Z)(i))};return(0,B.jsxs)(p.Z,{children:[(0,B.jsx)(f(),{children:(0,B.jsxs)(h.Z,{isOpen:Qe,toggle:function(){$e(!Qe)},centered:!0,size:"lg",children:[(0,B.jsx)(m.Z,{toggle:function(){$e(!Qe)},cssModule:{"modal-title":"w-100 text-center"},children:(0,B.jsx)(x.ZP,{container:!0,spacing:2,children:(0,B.jsx)(x.ZP,{style:{color:"var(--warning)",fontSize:"1.45rem",fontWeight:"bold",letterSpacing:"1px"},children:"Preview Liabiity Attachment"})})}),(0,B.jsxs)(y.Z,{className:"justify-content-center",children:[Ge&&(0,B.jsx)(C.$j,{}),!Ge&&(0,B.jsx)("div",{children:(0,B.jsx)("iframe",{style:{height:"400px",width:"100%"},className:"myiframe",title:"Aaq",src:"".concat(Ot,"#zoom=200")})})]})]})}),(0,B.jsx)(S.Z,{modalMessage:"Are you sure you want to delete this record?",handleConfirm:function(){!function(e){var t=JSON.parse(JSON.stringify(U)),n=t.findIndex((function(t){return t.id===e})),i=[];if(console.log(n,"id"),n>=0){var a=t[n].liabilityDetails.filter((function(e){return"File"===e.type}));console.log(a),a.forEach((function(e){var t=e.val.split("#~#");null!==t&&void 0!==t&&t[1]&&(console.log("liability delete",t),P().delete("/backendapi/document/deletebyid/".concat(t[1]),{headers:{Authorization:"Bearer ".concat(sessionStorage.getItem("authtoken"))}}))})),t[n].nominees.forEach((function(e){e.objectid=t[n].id,i.push(e)})),t.splice(n,1),J({_id:null===V||void 0===V?void 0:V._id,liabilities:(0,M.G)(JSON.stringify(t)),nominees:Ke,deletednominee:i}),Kt(),Xt(),Lt(!0),C.A9}}(ae),H(!1)},isOpen:q,closeModal:function(){return H(!1)}}),(0,B.jsx)(T.Z,{show:Pe,data:Ee,updateData:e.updateData,addData:Rt,isLoading:Te,handleSidebar:Tt,thumbView:L,getData:D,dataParams:O,addNew:Ie}),(0,B.jsxs)(x.ZP,{container:!0,spacing:2,sx:{p:.5},children:[(0,B.jsx)(x.ZP,{item:!0,xs:12,sm:8,children:(0,B.jsxs)(g.Z,{children:[(0,B.jsx)(C.ll,{title:(null!==(t=null===v||void 0===v?void 0:v.subHeading)&&void 0!==t?t:yt)?"Edit Liability Details":"Add New Liability"}),(0,B.jsxs)(b.Z,{children:[(0,B.jsxs)(x.ZP,{container:!0,spacing:1,children:[(0,B.jsx)(x.ZP,{item:!0,xs:12,sm:6,children:(0,B.jsx)(I.gc,{name:"liability",isDisabled:yt,options:W,id:"liabilityID",onChange:function(e,t){return function(e){var t;Lt(!0),(0,N.L9)(),ce(""),fe(""),Xe([]),st(""),we(null!==(t=null===e||void 0===e?void 0:e.value)&&void 0!==t?t:void 0),ut(e?G[e.value]:{})}(t)},value:(0,N.NA)(W,Se),renderInput:function(e){var t;return(0,B.jsx)(k.Z,(0,i.Z)((0,i.Z)({},e),{},{placeholder:null!==(t=null===v||void 0===v?void 0:v.liabilityOptionText)&&void 0!==t?t:"Liability Type"}))}})}),(0,B.jsx)(x.ZP,{item:!0,xs:12,sm:6,children:(0,B.jsx)(I.gc,{isMulti:!0,id:"nominee",name:"nominee",options:_t,value:Ke.map((function(e){var t=_t.filter((function(t){return t.value===e.id}));return{value:t[0].value,label:t[0].label}})),onChange:function(e,t){return function(e){yt&&Lt(!1);var t=[];(null===e||void 0===e?void 0:e.length)&&e.forEach((function(e){"Add Nominee"===e.value?De(!0):t.push({id:e.value,name:e.label})})),Xe([].concat(t))}(t)},renderInput:function(e){var t;return(0,B.jsx)(k.Z,(0,i.Z)((0,i.Z)({},e),{},{placeholder:null!==(t=null===v||void 0===v?void 0:v.nomineeOption)&&void 0!==t?t:"Nominee(s)"}))}})}),Object.keys(G).includes(Se)&&dt.map((function(e,t){return(0,B.jsx)(x.ZP,{item:!0,xs:12,sm:6,children:"Attachments"!==e.key?(0,B.jsxs)(B.Fragment,{children:[e.deletable&&(0,B.jsx)(F.Z,{style:{position:"absolute",right:"-5px",top:"-7px"},className:"primary",size:15,onClick:function(){return function(e){yt&&Lt(!1);var t=dt.filter((function(t){return e.key!==t.key}));ut(t)}(e)}}),(0,B.jsx)(k.Z,{margin:"normal",size:"small",fullWidth:!0,type:e.type,onKeyPress:function(t){"number"===e.type.toLowerCase()&&((0,E.ZP)(t),function(e){var t=(null===e||void 0===e?void 0:e.keyCode)||(null===e||void 0===e?void 0:e.which),n=document.getElementById("liabSubmit");13===t&&(!n||n.disabled||Ct||(yt?$t(e):Ht(e)))}(t))},name:e.key,id:e.id,rows:"1",className:"input-label placeholder ",placeholder:e.key,max:"9999-12-31",min:"1900-01-01",value:"File"!==e.type?e.val:null,onChange:function(t){Vt(t.target?t.target.value:t.value,e,t)}})]}):yt&&!pt&&e.val.split("#~#")[1]?(0,B.jsxs)("div",{className:"form-control",children:[(0,B.jsx)(F.Z,{style:{position:"absolute",right:"-5px",top:"-7px"},className:"primary",size:15,onClick:function(){ht(e.val.split("#~#")[1])}}),(0,B.jsx)("span",{style:{color:"blue"},onClick:function(){Jt(e.val.split("#~#")[2])},children:e.val.split("#~#")[0]})]}):(0,B.jsx)(k.Z,{margin:"normal",size:"small",fullWidth:!0,type:e.type,value:null,id:"fileAtt",onChange:function(t){Vt(t.target?t.target.value:t.value,e,t)}})},t)}))]}),(0,B.jsxs)(Z.Z,{direction:"row",spacing:3,sx:{mt:3},justifyContent:"end",children:[Se&&(0,B.jsx)(j.Z,{onClick:Gt,children:"Add Custom Field"}),(0,B.jsx)(I.ZP,{varient:"outlined",label:yt?"Cancel":null!==(n=null===v||void 0===v?void 0:v.resetButton)&&void 0!==n?n:"Reset",onClick:function(e){gt(!1),Kt()}}),(0,B.jsx)(I.ZP,{varient:"contained",id:"assetSubmit",spinload:Ct,label:yt?"Update":null!==(d=null===v||void 0===v?void 0:v.submitButton)&&void 0!==d?d:"Add",disabled:!pt&&(0===Ke.length||!Se||At||Ct),onClick:function(e){yt?$t(e):Ht(e)}})]})]})]})}),(0,B.jsx)(w.Z,{}),(0,B.jsx)(x.ZP,{item:!0,xs:12,children:(0,B.jsx)(A.ZP,{heading:null!==v&&void 0!==v&&v.textList?v.textList:"Liabilities List",isLoading:e.listLoading,collapseItems:be,show:function(){xe(!me),z()},assetShow:me})})]}),(0,B.jsx)(R.Id,{modal:nt,fname:re,ftype:ve,loading:Ge,addfield:function(){if(""!==Se){var e=dt,t=e.length,n="";if(e.findIndex((function(e){return e.key===re}))>=0)return(0,B.jsx)(C.A9,{handleClick:function(){},openSnack:!0,openSnackMsg:"Field Already Exist! Please add new field",severity:"error"});"Attachments"===dt[t-1].key?(n=e[t-1],e[t-1]={key:re,val:"",type:ve,deletable:!0},e.push(n),ut(e),ce(""),fe("")):(e.push({key:re,val:"",type:ve,deletable:!0}),ut(e),ce(""),fe("")),Gt()}},messages:v,setfname:ce,setftype:fe,assetType:Se,toggleModal:Gt,selectCustomRef:Y,clearCustomField:Xt})]})}))}}]);