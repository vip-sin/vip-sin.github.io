"use strict";(self.webpackChunkvpn=self.webpackChunkvpn||[]).push([[29],{39500:function(e,n,t){t(47313);var a=t(94469),r=t(69625),o=t(47605),i=t(9506),l=t(61474),s=t(46417);n.Z=function(e){var n=e.modalMessage,t=e.handleConfirm,u=e.isOpen,d=e.closeModal,c=e.confirmText,p=void 0===c?"Delete":c,v=e.cancelText,f=void 0===v?"Cancel":v,h=e.warning,m=void 0===h?"":h,x=n||"Are you sure you want to delete this record?";return(0,s.jsx)("div",{children:(0,s.jsx)(a.Z,{open:!!u,children:(0,s.jsxs)(r.Z,{children:[(0,s.jsx)(o.Z,{children:x}),(0,s.jsxs)(i.Z,{sx:{display:"flex",justifyContent:"flex-end"},children:[!m&&(0,s.jsx)(l.AG,{handleClick:d,label:f}),(0,s.jsx)(l.k4,{label:m?"Ok":p,handleClick:t})]})]})})})}},54727:function(e,n,t){t.d(n,{Yd:function(){return a},cc:function(){return o},p6:function(){return r}});n.ZP=function(e){var n=(null===e||void 0===e?void 0:e.keyCode)||(null===e||void 0===e?void 0:e.which);n=String.fromCharCode(n);if(!/^[0-9]*$/.test(n))return e.preventDefault(),!1};var a=RegExp(/^[6-9]{1}[0-9]{9}$/),r=function(e,n){var t="";if(!e)return t;var a=new Date(e),r=a.getFullYear(),o="".concat(a.getMonth()+1),i="".concat(a.getDate());if(o.length<2&&(o="0".concat(o)),i.length<2&&(i="0".concat(i)),"dd/mm/yyyy"===n)t=[i,o,r].join("/");else t=[i,o,r].join("-");return t},o=function(e){var n="".concat(e.getMonth()+1);1===n.length&&(n="0".concat(n));var t="".concat(e.getDate());return 1===t.length&&(t="0".concat(t)),[e.getFullYear(),n,t].join("-")}},87029:function(e,n,t){t.r(n),t.d(n,{default:function(){return ee}});var a=t(29439),r=t(47313),o=t(9506),i=t(19641),l=t(39500),s=t(45987),u=t(74165),d=t(15861),c=t(54727),p=t(80571),v=["id"],f=JSON.parse(sessionStorage.getItem("logInUserData")),h=p.g.injectEndpoints({endpoints:function(e){return{getExpense:e.query({query:function(e){var n={};if(null!==e&&void 0!==e&&e.year){var t=new Date,a=(0,c.cc)(t),r=Number(e.year?e.year:3);t.setMonth(t.getMonth()-r),t.setDate(1);var o=(0,c.cc)(t);n.dateRangeStart=o,n.dateRangeEnd=a}return null!==e&&void 0!==e&&e.labels&&(n.labels=e.labels),console.log("params",n),{url:"/backendapi/spend/list/".concat(f._id),method:"GET",params:n}},providesTags:["Expense"]}),getCount:e.query({query:function(e){return"/backendapi/spend/count/".concat(f._id)},providesTags:["Expense"]}),addExpense:e.mutation({query:function(e){return e.userId=f._id,{url:"backendapi/spend/add",method:"POST",body:e}},invalidatesTags:["Expense"]}),deleteExpense:e.mutation({query:function(e){return{url:"/backendapi/spend/delete",method:"POST",body:e}},invalidatesTags:["Expense"],onQueryStarted:function(e,n){return(0,d.Z)((0,u.Z)().mark((function e(){var t,a;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.dispatch,a=n.queryFulfilled,e.prev=1,e.next=4,a.then((function(e){t(h.endpoints.getData.initiate())}));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.log("efbuifwbi delete",e.t0);case 9:case"end":return e.stop()}}),e,null,[[1,6]])})))()}}),updateExpense:e.mutation({query:function(e){return e.userId=f._id,{url:"/backendapi/spend/update",method:"POST",body:e}},invalidatesTags:["Expense"],onQueryStarted:function(e,n){return(0,d.Z)((0,u.Z)().mark((function t(){var a,r;return(0,u.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.id,(0,s.Z)(e,v),a=n.dispatch,r=n.queryFulfilled,t.prev=2,t.next=5,r.then((function(e){a(h.endpoints.getData.initiate())}));case 5:t.next=10;break;case 7:t.prev=7,t.t0=t.catch(2),console.log("efbuifwbi update",t.t0);case 10:case"end":return t.stop()}}),t,null,[[2,7]])})))()}}),filterSpend:function(e){return function(n){return n({type:"FILTER_SPEND_DATA",value:e})}},filterExpense:function(e){return function(n){return n({type:"FILTER_DATA",value:e})}}}}}),m=h.useGetExpenseQuery,x=(h.useGetCountQuery,h.useAddExpenseMutation),b=h.useUpdateExpenseMutation,g=h.useDeleteExpenseMutation,Z=t(1413),j=t(49920),w=t(47605),y=t(19536),C=t(35898),D=t(8586),S=t(61474),E=t(52156),k=t(79428),L=t(46417),P=JSON.parse(sessionStorage.getItem("dropdowns")).dailySpendsLabels,A=function(e){var n=e.setsidebar,t=e.currentData,l=e.setcurrentData,s=(0,r.useState)(""),p=(0,a.Z)(s,2),v=p[0],f=p[1],h=(0,r.useState)("other"),m=(0,a.Z)(h,2),g=m[0],A=m[1],I=(0,r.useState)(""),T=(0,a.Z)(I,2),_=T[0],O=T[1],F=(0,r.useState)(""),N=(0,a.Z)(F,2),M=N[0],R=N[1],q=(0,r.useState)(""),G=(0,a.Z)(q,2),J=G[0],U=G[1],W=(0,r.useState)(""),z=(0,a.Z)(W,2),Q=z[0],Y=z[1],V=x(),$=(0,a.Z)(V,2),B=$[0],K=$[1],H=K.isError,X=K.isSuccess,ee=K.isLoading,ne=K.error,te=b(),ae=(0,a.Z)(te,1)[0];(0,r.useEffect)((function(){if(t){var e=t.name,n=t.relation,a=t.address,r=t.date,o=t.primaryContact;Y(e),f(n),A(null===t||void 0===t?void 0:t.relation1),R(a),O(r),U(o)}}),[t]),(0,r.useEffect)((function(){X&&(n(!1),l(null))}),[X]);var re=function(e){var n=e.target.name,t=e.target.value;switch(n){case"item":Y(t);break;case"description":R(t);break;case"date":O(t);break;case"price":t>=0&&t<=999999999999999&&U(t);break;case"relation1":A(t)}},oe=function(){var e=(0,d.Z)((0,u.Z)().mark((function e(){var n;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"others"===(n={label:null===v||void 0===v?void 0:v.trim(),label1:null===g||void 0===g?void 0:g.trim(),date:null===_||void 0===_?void 0:_.trim(),desc:null===M||void 0===M?void 0:M.trim(),amount:J,item:null===Q||void 0===Q?void 0:Q.trim()}).relation&&n.relation1&&(n.relation=n.relation1),null!==t?(n._id=t._id,n.usage=t.usage,ae(n)):B(n);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,L.jsx)(j.Z,{anchor:"right",open:!0,onClose:function(){return l(null)},onOpen:function(){},children:(0,L.jsxs)(o.Z,{sx:{mt:10,width:350,px:2},component:"form",children:[(0,L.jsxs)(i.ZP,{item:!0,sx:{display:"flex",justifyContent:"space-between",p:1},children:[(X||H)&&(0,L.jsx)(w.Z,{severity:X?"success":H&&"error",children:X?null!==t?"Updated":"Added":ne}),(0,L.jsx)(w.Z,{children:null!==t?"UPDATE SPEND DETAILS":"ADD NEW SPEND"}),(0,L.jsx)(D.Z,{size:20,onClick:function(){l(null),n(!1)}})]}),(0,L.jsx)(y.Z,{}),(0,L.jsx)(E.Z,{name:"item",value:Q,margin:"dense",placeholder:"Item *",onChange:re,id:"data-name"}),(0,L.jsx)(i.ZP,{item:!0,sx:{mt:1},children:(0,L.jsx)(S.gc,{id:"labelId",name:"label",value:(0,k.NA)(P,v),onChange:function(e,n){return function(e){var n=null===e||void 0===e?void 0:e.value;f(n),"Others"!==n&&A("")}(n)},options:P,renderInput:function(e){return(0,L.jsx)(E.Z,(0,Z.Z)((0,Z.Z)({},e),{},{placeholder:"Select Label *"}))}})}),"Others"===v&&(0,L.jsx)(E.Z,{margin:"dense",name:"relation1",value:g,placeholder:"Label Name",onChange:re,id:"data-name"}),(0,L.jsx)(E.Z,{type:"date",value:_,name:"date",margin:"dense",placeholder:"Enter Date",id:"data-name",InputLabelProps:{shrink:!0},onChange:re,InputProps:{inputProps:{min:(0,k.BZ)(),max:"9999-12-31"}}}),(0,L.jsx)(E.Z,{type:"tel",onKeyPress:function(e){return(0,c.ZP)(e)},value:J,margin:"dense",id:"data-price",name:"price",max:999999999999999,placeholder:"Enter spend amount *",onChange:re}),(0,L.jsx)(E.Z,{type:"textarea",value:M,margin:"dense",name:"description",placeholder:"Description",id:"data-name",onChange:re}),(0,L.jsxs)(C.Z,{spacing:3,direction:"row",sx:{mt:3,justifyContent:"end"},children:[(0,L.jsx)(S.ZP,{varient:"outlined",label:null!==t?"Cancel":"Reset",onClick:function(){l(null),n(!1)}}),(0,L.jsx)(S.ZP,{varient:"contained",onClick:function(){return oe()},disabled:function(){var e=!(null!==Q&&void 0!==Q&&Q.length)||!(null!==v&&void 0!==v&&v.length)||"Others"===v&&!(null!==g&&void 0!==g&&g.length)||!J||!(null!==_&&void 0!==_&&_.length),n=null!==t&&Q===(null===t||void 0===t?void 0:t.name)&&v===(null===t||void 0===t?void 0:t.relation)&&g===(null===t||void 0===t?void 0:t.relation1)&&M===(null===t||void 0===t?void 0:t.address)&&_===(null===t||void 0===t?void 0:t.date)&&J===(null===t||void 0===t?void 0:t.primaryContact);return e||n}(),label:null!==t?"Update":"Add",isLoading:ee})]})]})})},I=t(71003),T=t(8047),_=function(e){var n=e.setsidebar,t=e.label,a=e.dailySpendsLabels,r=e.changelabelFilter,i=e.setyear,l=e.year,s=e.getData,u=e.getValue,d=[{label:"Last 3 month",value:3},{label:"Last 6 month",value:6},{label:"Last 1 year",value:12},{label:"Last 3 years",value:36}];return(0,L.jsxs)(o.Z,{children:[(0,L.jsx)(I.Z,{variant:"contained",onClick:function(){return n(!0)},sx:{mb:2},children:"Add Expense"}),(0,L.jsx)(y.Z,{sx:{mb:2}}),(0,L.jsx)(S.gc,{isMulti:!0,id:"data-category",name:"label",value:null===t||void 0===t?void 0:t.map((function(e){var n=a.filter((function(n){return n.value===e.value}));return{value:n[0].value,label:n[0].label}})),autoComplete:"expense",onChange:function(e,n){return r(n)},options:a,renderInput:function(e){return(0,L.jsx)(T.Z,(0,Z.Z)((0,Z.Z)({},e),{},{placeholder:"Filter by label"}))}}),(0,L.jsx)(S.gc,{id:"dateID",name:"date",onChange:function(e,n){return i(null===n||void 0===n?void 0:n.value)},options:d,value:u(d,l),renderInput:function(e){return(0,L.jsx)(T.Z,(0,Z.Z)((0,Z.Z)({},e),{},{placeholder:"Date range filter",onChange:function(e){return i(null===e||void 0===e?void 0:e.value)}}))}}),(0,L.jsx)(I.Z,{variant:"outlined",onClick:function(e){s({labels:t.map((function(e){return e.value})).join(","),year:l})},children:"Filter"})]})},O=t(93433),F=t(48737),N=t(56605),M=t(49709),R=t(80836),q=t(57775),G=t(20938),J=t(71207),U=t(35192),W=t(11610),z=t(18377),Q=t(98668),Y=t(25160),V=t(86028),$=function(e){return(0,L.jsx)(J.Z,{size:15,onClick:function(){return e.currentData(e.row)}})},B=function(e){return(0,L.jsx)(U.Z,{size:15,onClick:function(){return e.setRow()}})},K=function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.preventDefault();var a=F.P6.book_new(),r="Spenditure_Report.xlsx";if(t){var o=[];n[t].forEach((function(e){o.push({Month:e.seperator,Date:e.date,Label:e.label,Item:e.item,Amount:"\u20b9".concat(e.amount),Description:e.desc,"Created At":(0,c.p6)(e.updatedAt)})}));var i=F.P6.json_to_sheet(o),l=[{wch:14},{wch:10},{wch:25},{wch:20},{wch:7},{wch:25},{wch:10}];i["!cols"]=l,i.A1.s={font:{sz:24,bold:!0,color:{rgb:"FFAA00"}}},F.P6.book_append_sheet(a,i,t),r="Spediture_Report-".concat(t,".xlsx")}else Object.keys(n).forEach((function(e){var t=[];n[e].forEach((function(e){t.push({Month:e.seperator,Date:e.date,Label:e.label,Item:e.item,Amount:e.amount,Description:e.desc,"Created At":(0,c.p6)(e.updatedAt)})}));var r=F.P6.json_to_sheet(t);r["!cols"]=[{wch:14},{wch:10},{wch:25},{wch:20},{wch:7},{wch:25},{wch:10}],F.P6.book_append_sheet(a,r,e)}));(0,F.NC)(a,r)},H=function(e){var n=m(),t=n.data,a=n.isFetching,l=e.setDeleteRow,s=e.setopen,u=e.setsidebar,d=e.splitdata,p=e.setsplitdata,v=e.setcurrentData,f=function(e){e&&e.forEach((function(n,t){if(n.date){var a=new Date(n.date),r=new Intl.DateTimeFormat("en",{year:"numeric"}).format(a),o=new Intl.DateTimeFormat("en",{month:"long"}).format(a);e[t].seperator="".concat(o,", ").concat(r)}}));var n=x(e,"seperator");p(n)};(0,r.useEffect)((function(){if(null!==t&&void 0!==t&&t.length){var e=JSON.parse(JSON.stringify(t));e.map((function(e){var n,t=null===e||void 0===e||null===(n=e.date)||void 0===n?void 0:n.split("T");return e.date=null===t||void 0===t?void 0:t[0],e})),f((0,O.Z)(e))}}),[t]);var h=[{label:"Edit",cell:function(e){return(0,L.jsx)($,{row:e,currentData:b})}},{label:"Item",id:"item",cell:function(e){return e.item}},{label:"Description",id:"desc",cell:function(e){return e.desc}},{label:"Label",id:"label",cell:function(e){return(null===e||void 0===e?void 0:e.label1)||(null===e||void 0===e?void 0:e.label)}},{label:"Date",id:"date",cell:function(e){return(0,c.p6)(null===e||void 0===e?void 0:e.date)}},{label:"Amount",id:"amount",cell:function(e){return e.amount}},{label:"Delete",cell:function(e){return(0,L.jsx)(B,{row:e,setRow:function(){l(e),s(!0)}})}}],x=function(e,n){return e.reduce((function(e,t){return e[t[n]]||(e[t[n]]=[]),e[t[n]].push(t),e}),{})},b=function(e){e.name=e.item,e.relation=e.label,e.relation1=e.label1,e.address=e.desc,e.primaryContact=e.amount,v(e),u(!0)};return(0,L.jsx)(i.ZP,{item:!0,xs:8,md:9,lg:10,children:a?(0,L.jsx)(Q.Z,{}):(0,L.jsx)(o.Z,{children:(0,L.jsxs)(Y.Z,{disableGutters:!1,maxWidth:!1,children:[(0,L.jsxs)(V.Z,{direction:"row",sx:{mb:5},justifyContent:"space-between",children:[(0,L.jsx)(N.Z,{onChange:function(e){return function(e){var n=e.target.value;if(n.length){var a=(t.length?t:null!==d&&void 0!==d?d:[]).filter((function(e){var t,a,r,o,i=e.desc,l=e.item,s=e.amount,u=e.label;return r=(null===i||void 0===i?void 0:i.toLowerCase().startsWith(n.toLowerCase()))||(null===l||void 0===l?void 0:l.toLowerCase().startsWith(n.toLowerCase()))||(null===(t=toString(s))||void 0===t?void 0:t.toLowerCase().startsWith(n.toLowerCase()))||(null===u||void 0===u?void 0:u.toLowerCase().includes(n.toLowerCase())),o=(null===i||void 0===i?void 0:i.toLowerCase().includes(n.toLowerCase()))||(null===l||void 0===l?void 0:l.toLowerCase().includes(n.toLowerCase()))||(null===(a=toString(s))||void 0===a?void 0:a.toLowerCase().includes(n.toLowerCase()))||(null===u||void 0===u?void 0:u.toLowerCase().includes(n.toLowerCase())),r||(!r&&o?o:null)}));f(a)}else f(t)}(e)},placeholder:"Search"}),(0,L.jsx)(M.Z,{title:"Download",children:(0,L.jsx)(R.Z,{onClick:function(e){return K(e,d)},children:(0,L.jsx)(W.Z,{})})})]}),Object.keys(d).map((function(e,n){var t,a=null===(t=d[e])||void 0===t?void 0:t.map((function(e){return Number(e.amount)})).reduce((function(e,n){return e+n}));return(0,L.jsxs)(q.Z,{sx:{p:2},children:[(0,L.jsxs)(i.ZP,{container:!0,spacing:1,sx:{display:"flex",justifyContent:"space-around"},children:[(0,L.jsxs)(w.Z,{children:["Total Spends :",a]}),(0,L.jsx)(w.Z,{children:e}),(0,L.jsx)(z.Z,{onClick:function(n){return K(n,d,e)}})]}),(0,L.jsx)(y.Z,{}),(0,L.jsx)(G.Gn,{columns:h,rows:d[e]})]},n+1)}))]})})})},X=JSON.parse(sessionStorage.getItem("dropdowns")).dailySpendsLabels,ee=function(e){var n=(0,r.useState)([]),t=(0,a.Z)(n,2),s=t[0],u=t[1],d=(0,r.useState)(),c=(0,a.Z)(d,2),p=c[0],v=c[1],f=(0,r.useState)(!1),h=(0,a.Z)(f,2),m=h[0],x=h[1],b=(0,r.useState)(""),Z=(0,a.Z)(b,2),j=Z[0],w=Z[1],y=(0,r.useState)(!1),C=(0,a.Z)(y,2),D=C[0],S=C[1],E=(0,r.useState)(null),P=(0,a.Z)(E,2),I=P[0],T=P[1],O=(0,r.useState)({}),F=(0,a.Z)(O,2),N=F[0],M=F[1],R=g(),q=(0,a.Z)(R,1)[0];return(0,L.jsxs)(o.Z,{children:[(0,L.jsx)(l.Z,{handleConfirm:function(){q(j),x(!1)},isOpen:m,closeModal:function(){return x(!1)}}),D&&(0,L.jsx)(A,{currentData:I,setcurrentData:T,setsidebar:S}),(0,L.jsxs)(i.ZP,{container:!0,sx:{p:2},children:[(0,L.jsx)(i.ZP,{item:!0,xs:4,md:3,lg:2,sx:{borderRight:"1px solid",p:1},children:(0,L.jsx)(_,{setsidebar:S,label:s,dailySpendsLabels:X,changelabelFilter:function(e){var n=[];(null===e||void 0===e?void 0:e.length)&&e.forEach((function(e){n.push(e)})),console.log(n),u(n)},setyear:v,year:p,getData:e.getData,getValue:k.NA})}),(0,L.jsx)(H,{setDeleteRow:w,setsidebar:S,setcurrentData:T,splitdata:N,setsplitdata:M})]})]})}}}]);