"use strict";(self.webpackChunkvpn=self.webpackChunkvpn||[]).push([[106],{4106:function(e,n,t){t.r(n),t.d(n,{default:function(){return q}});var a=t(74165),o=t(15861),i=t(29439),r=t(47313),l=t(64162),s=t.n(l),c=t(40229),u=t(71535),d=t(63861),v=t(96327),f=t(66135),h=t(97729),p=t(46095),g=t(46417),m=(0,p.Z)((0,g.jsx)("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4-8 5-8-5V6l8 5 8-5v2z"}),"Mail"),x=t(91210),Z=t(18377),j=t(35192),y=t(51427),k=t(1413),w=t(31881),S=t.n(w),b=t(7081),C=t(5448),A=t(88356),D=t(45959),L=t(89870),z=t(86240),M=t(61474),E=sessionStorage.getItem("authtoken"),I=JSON.parse(sessionStorage.getItem("logInUserData")),N=[{value:"1h",label:"1 Hour"},{value:"1d",label:"1 Day"},{value:"1w",label:"1 Week"},{value:"1m",label:"1 Month"}],P=[{value:!0,label:"Allow Download"},{value:!1,label:"Allow View Only"}],U=(0,f.$j)((function(e){var n;return{docsList:null===(n=e.reducer.dataList)||void 0===n?void 0:n.docsList}}),(function(e){return{getDocuments:function(n){return e((0,y.qi)(n))}}}))((function(e){var n=(0,r.useState)(""),t=(0,i.Z)(n,2),a=t[0],o=t[1],l=(0,r.useState)(""),s=(0,i.Z)(l,2),c=s[0],v=s[1],f=(0,r.useState)(""),h=(0,i.Z)(f,2),p=h[0],m=h[1],x=(0,r.useState)(!1),Z=(0,i.Z)(x,2),j=Z[0],y=Z[1];return console.log(e.loading),(0,g.jsx)(g.Fragment,{children:(0,g.jsxs)(b.Z,{open:e.modal,onClose:function(){e.toggleModal()},centered:!0,size:"lg",fullWidth:!0,children:[(0,g.jsx)(C.Z,{children:"Send as mail"}),(0,g.jsxs)(A.Z,{children:[e.loading&&(0,g.jsx)(D.Z,{}),!e.loading&&(0,g.jsxs)(u.ZP,{container:!0,spacing:2,children:[(0,g.jsx)(u.ZP,{item:!0,xs:6,children:(0,g.jsx)(d.nv,{value:a,label:"Email *",onChange:function(e){return o(e.target.value)},placeholder:"Enter Email"})}),(0,g.jsx)(u.ZP,{item:!0,xs:6,children:(0,g.jsx)(d.nv,{value:c,label:"Name *",onChange:function(e){return v(e.target.value)},placeholder:"Enter Name"})}),(0,g.jsx)(u.ZP,{item:!0,xs:6,children:(0,g.jsx)(M.gc,{id:"data-category",name:"label",onChange:function(e,n){return m(null===n||void 0===n?void 0:n.value)},options:N,value:(0,z.NA)(N,p),renderInput:function(e){return(0,g.jsx)(d.nv,(0,k.Z)((0,k.Z)({},e),{},{placeholder:"Expiry for Documents *"}))}})}),(0,g.jsx)(u.ZP,{item:!0,xs:6,children:(0,g.jsx)(M.gc,{id:"data-category",onChange:function(e,n){return y(null===n||void 0===n?void 0:n.value)},name:"label",options:P,value:(0,z.NA)(P,j),renderInput:function(e){return(0,g.jsx)(d.nv,(0,k.Z)((0,k.Z)({},e),{},{placeholder:"Allow Download"}))}})}),(0,g.jsx)(u.ZP,{item:!0,xs:12,justifyContent:"center",children:(0,g.jsx)(L.Z,{onClick:function(n){if(n.preventDefault(),""===a)return(0,g.jsx)(d.A9,{handleClick:function(){},openSnack:!0,openSnackMsg:"Enter reciver Mail Id",severity:"warning"});if(""===c)return(0,g.jsx)(d.A9,{handleClick:function(){},openSnack:!0,openSnackMsg:"Enter reciver Name",severity:"warning"});if(""===p)return(0,g.jsx)(d.A9,{handleClick:function(){},openSnack:!0,openSnackMsg:"Select Document Expiry",severity:"warning"});var t=new Date;"1m"===p?t.setMonth(t.getMonth()+1):"1d"===p?t.setDate(t.getDate()+1):"1w"===p?t.setDate(t.getDate()+7):"1h"===p&&t.setHours(t.getHours()+1);var i={email:a,name:c,expiry:t,allowdownload:j,docs:e.mailAtt,status:0,user:null===I||void 0===I?void 0:I._id};S().post("/backendapi/documentmail",i,{headers:{Authorization:"Bearer ".concat(E)}}).then((function(n){return"Success"===(null===n||void 0===n?void 0:n.data)?(o(""),v(""),m(""),y(!1),e.toggleModal(),(0,g.jsx)(d.A9,{handleClick:function(){},openSnack:!0,openSnackMsg:"Mail sent successfully"})):(0,g.jsx)(d.A9,{handleClick:function(){},openSnack:!0,openSnackMsg:"Mail sent failed. Please check email address",severity:"error"})}))},variant:"contained",children:"Send"})})]})]})]})})})),B=t(71639),R=t(62463),T=t(71363),O=(0,p.Z)((0,g.jsx)("path",{d:"M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z"}),"ChevronLeft"),V=(0,p.Z)((0,g.jsx)("path",{d:"M10 6 8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}),"ChevronRight"),H=t(49461),_=t.n(H),F=function(e){var n=e.modal,t=e.setprevidx,a=e.loading,o=e.bloburl,i=e.selectedforpreview,r=e.selectedatt,l=e.previdx,s=e.setDeleteId,c=e.setopen,d=e.toggleModal,f=e.open,h=e.deletedoc,p=e.preview;return(0,g.jsx)(_(),{children:(0,g.jsxs)(b.Z,{open:n,onClose:function(){d(),t(0)},centered:!0,size:"lg",fullWidth:!0,children:[(0,g.jsx)(C.Z,{toggle:function(){d(),t(0)},children:(0,g.jsxs)(R.Z,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[!a&&(0,g.jsx)("a",{href:o,download:null===i||void 0===i?void 0:i.name,tabIndex:"_balnk",style:{cursor:"pointer",display:"flex"},children:(0,g.jsx)(Z.Z,{size:25,color:"primary"})}),!a&&r.length>1&&(0,g.jsx)(j.Z,{style:{cursor:"pointer",display:"flex"},color:"primary",size:25,className:"collapse-icon",onClick:function(){s(i._id),c(!0)}}),(0,g.jsxs)(u.ZP,{style:{justifyContent:"center"},children:[l>0&&!a&&(0,g.jsx)(O,{style:{cursor:"pointer"},color:"primary",size:25,onClick:function(){p(r[l-1]),t(l-1)}}),r.length>l+1&&!a&&(0,g.jsx)(V,{size:25,style:{cursor:"pointer"},color:"primary",onClick:function(){p(r[l+1]),t(l+1)}})]}),(0,g.jsxs)(T.Z,{style:{color:"var(--warning)",fontSize:"1.45rem",fontWeight:"bold",letterSpacing:"1px"},children:["Preview ",l+1," of ",null===r||void 0===r?void 0:r.length]})]})}),(0,g.jsxs)(A.Z,{className:"justify-content-center",children:[(0,g.jsx)(v.Z,{handleConfirm:function(){h(),c(!1)},isOpen:f,closeModal:function(){return c(!1)}}),a&&(0,g.jsx)(D.Z,{}),!a&&(0,g.jsx)("div",{children:(0,g.jsx)("iframe",{style:{height:"500px",width:"100%"},title:"Aaq",src:"".concat(o)})})]})]})})},W=t(54727),G=sessionStorage.getItem("authtoken"),Y=JSON.parse(sessionStorage.getItem("logInUserData")),q=(0,f.$j)((function(e){var n;return{docsList:null===(n=e.reducer.dataList)||void 0===n?void 0:n.docsList}}),(function(e){return{getDocuments:function(n){return e((0,y.qi)(n))}}}))((function(e){var n=[{label:"Send",id:"send",cell:function(e){return(0,g.jsx)(m,{onClick:function(){return We(e.attachment)}})}},{label:"View",id:"view",cell:function(e){return(0,g.jsx)(x.Z,{style:{cursor:"pointer"},size:20,onClick:function(){L(e._id),I(e.attachment),He(),_e(e.attachment[0])}})}},{label:"Name / Alias",id:"alias",cell:function(e){return e.alias}},{label:"Expiry",id:"expiry",sortable:!0,cell:function(e){return(null===e||void 0===e?void 0:e.expiry)&&(0,W.p6)(e.expiry.split("T")[0])}},{label:"Created At",id:"createdat",cell:function(e){return(null===e||void 0===e?void 0:e.createdAt)&&(0,W.p6)(e.createdAt.split("T")[0])}},{label:"Type",id:"type",cell:function(e){return e.type}},{label:"Download",id:"download",cell:function(e){return(0,g.jsx)(Z.Z,{size:20,onClick:function(){return Fe(e.attachment)}})}},{label:"Trash",id:"trash",cell:function(e){return"Document Vault"===e.type&&(0,g.jsx)(j.Z,{size:20,onClick:function(){Ve(e._id),Be(!0)}})}}],t=(0,r.useState)(!1),l=(0,i.Z)(t,2),f=l[0],p=l[1],y=(0,r.useState)(),k=(0,i.Z)(y,2),w=k[0],b=k[1],C=(0,r.useState)(),A=(0,i.Z)(C,2),D=A[0],L=A[1],z=(0,r.useState)([]),M=(0,i.Z)(z,2),E=M[0],I=M[1],N=(0,r.useState)(0),P=(0,i.Z)(N,2),R=P[0],T=P[1],O=(0,r.useState)([]),V=(0,i.Z)(O,2),H=V[0],_=V[1],q=(0,r.useState)([]),J=(0,i.Z)(q,2),$=J[0],K=J[1],Q=(0,r.useState)(!1),X=(0,i.Z)(Q,2),ee=X[0],ne=X[1],te=(0,r.useState)(!1),ae=(0,i.Z)(te,2),oe=ae[0],ie=ae[1],re=(0,r.useState)(""),le=(0,i.Z)(re,2),se=le[0],ce=le[1],ue=(0,r.useState)(""),de=(0,i.Z)(ue,2),ve=de[0],fe=de[1],he=(0,r.useState)(""),pe=(0,i.Z)(he,2),ge=pe[0],me=pe[1],xe=(0,r.useState)([]),Ze=(0,i.Z)(xe,2),je=Ze[0],ye=Ze[1],ke=(0,r.useState)([]),we=(0,i.Z)(ke,2),Se=we[0],be=we[1],Ce=(0,r.useState)(),Ae=(0,i.Z)(Ce,2),De=Ae[0],Le=Ae[1],ze=(0,r.useState)(!1),Me=(0,i.Z)(ze,2),Ee=Me[0],Ie=Me[1],Ne=(0,r.useState)(!1),Pe=(0,i.Z)(Ne,2),Ue=Pe[0],Be=Pe[1],Re=(0,r.useState)(!1),Te=(0,i.Z)(Re,2),Oe=Te[0],Ve=Te[1],He=function(){p(!f)};(0,r.useEffect)((function(){if(null!==$&&void 0!==$&&$.length){var n,t=[];null===e||void 0===e||null===(n=e.docsList)||void 0===n||n.filter((function(n){var a=n.type,o=!1;return $.forEach((function(i){var r,l;return"all"===(null===i||void 0===i||null===(r=i.name)||void 0===r?void 0:r.toLowerCase())?ye(e.docsList):(o=(null===i||void 0===i||null===(l=i.name)||void 0===l?void 0:l.toLowerCase())===(null===a||void 0===a?void 0:a.toLowerCase()))?(t.push(n),o):void 0})),o})),ye(t)}else ye(e.docsList)}),[$]);var _e=function(e){ne(!0);var n=sessionStorage.getItem("authtoken");S().get("/backendapi/sender/msg/".concat(e),{headers:{Authorization:"Bearer ".concat(n)}}).then((function(e){var n;b(e.data[0]);var t=null===(n=e.data[0])||void 0===n?void 0:n.media,a=s().decompressFromUTF16(t),o=(0,h.Y)(a);if(!o)return He(),(0,g.jsx)(d.A9,{handleClick:function(){},openSnack:!0,openSnackMsg:"Something went wrong",severity:"warning"});for(var i,r=atob(null===o||void 0===o?void 0:o.split("base64,")[1]),l=new Array(r.length),c=0;c<r.length;c++)l[c]=r.charCodeAt(c);var u=new Uint8Array(l),v=new Blob([u],{type:null===(i=e.data[0])||void 0===i?void 0:i.type}),f=URL.createObjectURL(v);Le(f),ne(!1)}))},Fe=function(e){e.forEach((function(e){var n=sessionStorage.getItem("authtoken");S().get("/backendapi/sender/msg/".concat(e),{headers:{Authorization:"Bearer ".concat(n)}}).then((function(e){for(var n,t,a,o=(0,h.Y)(null===(n=e.data[0])||void 0===n?void 0:n.media),i=s().decompress(o),r=atob(i.split("base64,")[1]),l=new Array(r.length),c=0;c<r.length;c++)l[c]=r.charCodeAt(c);var u=new Uint8Array(l),d=new Blob([u],{type:null===(t=e.data[0])||void 0===t?void 0:t.type}),v=URL.createObjectURL(d),f=document.createElement("a");f.href=v,f.setAttribute("download","".concat(null===(a=e.data[0])||void 0===a?void 0:a.name)),document.body.appendChild(f),f.click(),f.parentNode.removeChild(f)}))}))},We=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(n){var t,o;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:tn(!0),Qe(!0),t=[],o=0;case 4:if(!(o<n.length)){e.next=10;break}return e.next=7,S().get("/backendapi/sender/msg/".concat(n[o]),{headers:{Authorization:"Bearer ".concat(G)}}).then((function(e){var n,a,o=(0,h.Y)(null===(n=e.data[0])||void 0===n?void 0:n.media),i=s().decompress(o),r=null===(a=e.data[0])||void 0===a?void 0:a.name;t.push({data:i,filename:r})}));case 7:o+=1,e.next=4;break;case 10:ln(t),tn(!1);case 12:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();(0,r.useEffect)((function(){e.getDocuments({user:Y,token:G})}),[]),(0,r.useEffect)((function(){ye(e.docsList)}),[e.docsList]);var Ge=function(e){return new Promise((function(n,t){var a=new FileReader;a.readAsDataURL(e),a.onload=function(){return n(a.result)},a.onerror=function(e){return t(e)}}))},Ye=function(){ce(""),me(""),fe(""),_([]),ie(!0)},qe=function(){var n=(0,o.Z)((0,a.Z)().mark((function n(t){var o,i,r,l,c,u;return(0,a.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.preventDefault(),Ie(!0),(null===H||void 0===H||!H.length)&&d.A9,null!==H&&void 0!==H&&H.length){n.next=5;break}return n.abrupt("return");case 5:o=[],(i={}).user=null===Y||void 0===Y?void 0:Y._id,i.type="Document Vault",i.alias=(0,h.G)(se),i.desc=(0,h.G)(ge),i.expiry=(0,h.G)(ve),r=0;case 13:if(!(r<H.length)){n.next=23;break}return n.next=16,Ge(H[r]);case 16:l=n.sent,c=(0,h.G)(l),u=s().compressToUTF16(c),o.push({media:u,name:H[r].name,type:H[r].type,user:null===Y||void 0===Y?void 0:Y._id});case 20:r++,n.next=13;break;case 23:i.attachment=o,S().post("/backendapi/documents/add",i,{headers:{Authorization:"Bearer ".concat(G)}}).then((function(n){Ye(),"Success"!==n.data&&(d.A9,n.data),e.getDocuments({user:Y,token:G})})).catch((function(e){var n,t;ce(),me(),fe(),ie(!0),(null===e||void 0===e||null===(n=e.response)||void 0===n?void 0:n.data)&&(d.A9,null===e||void 0===e||null===(t=e.response)||void 0===t||t.data)})).finally((function(){return Ie(!1)}));case 26:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),Je=(0,r.useState)(!1),$e=(0,i.Z)(Je,2),Ke=$e[0],Qe=$e[1],Xe=(0,r.useState)(!0),en=(0,i.Z)(Xe,2),nn=en[0],tn=en[1],an=(0,r.useState)([]),on=(0,i.Z)(an,2),rn=on[0],ln=on[1];return(0,g.jsxs)(c.Z,{children:[(0,g.jsx)(U,{modal:Ke,toggleModal:function(){return Qe(!Ke)},loading:nn,mailAtt:rn}),(0,g.jsx)(v.Z,{handleConfirm:function(){S().delete("/backendapi/document/deletebyid/".concat(Oe),{headers:{Authorization:"Bearer ".concat(G)}}).then((function(n){return e.getDocuments({user:Y,token:G}),(0,g.jsx)(d.A9,{handleClick:function(){},openSnack:!0,openSnackMsg:"Document Deleted Successfully"})})),Be(!1)},isOpen:Ue,closeModal:function(){return Be(!1)}}),f&&(0,g.jsx)(F,{modal:f,setprevidx:T,loading:ee,bloburl:De,selectedforpreview:w,selectedatt:E,previdx:R,setDeleteId:Ve,setopen:Be,open:Ue,toggleModal:He,deletedoc:function(n){S().delete("/backendapi/document/media/deletebyid/".concat(Oe,"/").concat(D),{headers:{Authorization:"Bearer ".concat(G)}}).then((function(n){return e.getDocuments({user:Y,token:G}),I([]),T(0),He(),(0,g.jsx)(d.A9,{handleClick:function(){},openSnack:!0,openSnackMsg:"Attachment deleted successfully!"})})).catch()},preview:_e}),(0,g.jsx)(u.ZP,{container:!0,spacing:1,sx:{p:1},children:(0,g.jsx)(B.zY,{alias:se,setalias:ce,expiry:ve,setexpiry:fe,desc:ge,setdesc:me,handleReset:Ye,isDisabled:Ee||!ve||!H.length||new Date(ve).getTime()<(new Date).getTime(),uploading:Ee,submitDropzone:qe,setfilesOndrop:function(e){ie(!1),_(e)},resetDropzone:oe})}),(0,g.jsx)(B.RS,{filter:$,handleFilter:function(e){var n=[];(null===e||void 0===e?void 0:e.length)&&e.forEach((function(e){n.push({id:e.value,name:e.label})})),K(n)},search:function(e){if(null!==je&&void 0!==je&&je.length){var n=je.filter((function(n){var t=n.desc,a=n.alias,o=(null===t||void 0===t?void 0:t.toLowerCase().startsWith(e.toLowerCase()))||(null===a||void 0===a?void 0:a.toLowerCase().startsWith(e.toLowerCase())),i=(null===t||void 0===t?void 0:t.toLowerCase().includes(e.toLowerCase()))||(null===a||void 0===a?void 0:a.toLowerCase().includes(e.toLowerCase()));return!(!o&&!i)}));be(n)}},columns:n,searchresult:Se,documentList:je})]})}))},18377:function(e,n,t){var a=t(46095),o=t(46417);n.Z=(0,a.Z)((0,o.jsx)("path",{d:"M5 20h14v-2H5v2zM19 9h-4V3H9v6H5l7 7 7-7z"}),"Download")},91210:function(e,n,t){var a=t(46095),o=t(46417);n.Z=(0,a.Z)((0,o.jsx)("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"}),"Visibility")}}]);