"use strict";(self.webpackChunkvpn=self.webpackChunkvpn||[]).push([[934],{32934:function(e,t,n){n.r(t),n.d(t,{default:function(){return M}});var i=n(1413),a=n(93433),l=n(74165),o=n(15861),s=n(29439),r=n(47313),u=n(95162),d=n(64162),c=n.n(d),v=n(40229),f=n(71535),p=n(96900),h=n(56972),m=n(62463),y=n(89870),x=n(39653),g=n(31616),b=n(39995),Z=n(62457),k=n(31881),S=n.n(k),j=n(66135),A=n(58470),D=n(86282),w=n(61474),L=n(35192),C=n(71363),P=n(54727),I=n(46417),F=function(e,t,n,i,a,l,o){var s=[];(null===o||void 0===o?void 0:o.length)&&o.forEach((function(l,o){if(l.id){var r,u="";(null===l||void 0===l||null===(r=l.nominees)||void 0===r?void 0:r.length)&&l.nominees.forEach((function(t,n){var i=e.data.filter((function(e){return e._id===t.id}));i.length&&(n===l.nominees.length-1?u+=i[0].name:u="".concat(u+i[0].name,", "))}));var d=(0,I.jsxs)(f.ZP,{container:!0,children:[l.liabilityDetails.map((function(e,n){if(""!==e.val){var i,a=e.val;if("File"===e.type){var l=e.val.split("#~#");a=(0,I.jsx)("u",{children:(0,I.jsx)("span",{style:{color:"blue",cursor:"pointer"},onClick:function(){return t(l[2])},children:l[0]})})}return(0,I.jsx)(f.ZP,{item:!0,sm:4,xs:12,children:(0,I.jsxs)(C.Z,{children:[e.key&&(null===(i=e.key.split("*"))||void 0===i?void 0:i[0])," :",(0,I.jsxs)("b",{children:[" ","Date"===e.type?(0,P.p6)(a):a," "]})]})},n+e.key)}return""})),(0,I.jsx)(f.ZP,{item:!0,sm:4,sx:12,children:(0,I.jsxs)(C.Z,{children:["Nominees :",(0,I.jsx)("b",{children:u})]})}),(0,I.jsxs)(f.ZP,{item:!0,display:"flex",sm:2,xs:12,children:[(0,I.jsx)(C.Z,{sx:{color:"blue",cursor:"pointer"},onClick:function(){return n(l)},children:"Edit"}),(0,I.jsx)(C.Z,{sx:{mx:1,color:"red",cursor:"pointer"},onClick:function(){i(l.id),a(!0)},children:"Delete"})]})]}),c={id:o+1,trashIt:function(){i(l.id),a(!0)},editIt:function(){n(l)},title:l.liabilityType,content:d};s.push(c)}})),l(null===s||void 0===s?void 0:s.reverse())},N=n(97729),E=n(10226),O=n(50850),B=n(23317),_=n(36936),z=n(72845),M=(0,j.$j)((function(e){var t,n,i=e.reducer,a=i.dataList,l=i.customizer,o=void 0===l?{}:l;return{dataList:a,liabilityListFromAPI:null!==(t=null===a||void 0===a?void 0:a.liabilityListFromAPI)&&void 0!==t?t:[],messages:null===o||void 0===o||null===(n=o.language)||void 0===n?void 0:n.Liability,listLoading:null===a||void 0===a?void 0:a.totalRecordsLoading,mediaData:null===a||void 0===a?void 0:a.mediaData}}),(function(e){return console.log("docsApi.endpoints.previewDoc",z.Xg.endpoints),{previewDoc:function(t){return e(z.Xg.endpoints.previewDoc.initiate(t,{subscribe:!1,forceRefetch:!0}))},resetPreview:function(t){return e(z.Xg.endpoints.resetPreview.initiate(t))},getData:function(t){return e(_.SD.endpoints.getData.initiate())},addLiabilityData:function(t){return e(B.sk.endpoints.addLiabilityData.initiate(t))},callLiabilityAPI:function(t){return e(B.sk.endpoints.getLiabilityData.initiate())}}}))((function(e){var t,n,d,k=e.messages,j=e.thumbView,C=e.getData,B=e.parsedFilter,_=e.callLiabilityAPI,z=e.liabilityListFromAPI,M=e.addLiabilityData,T=e.previewDoc,R=e.mediaData,J=e.resetPreview,U=JSON.parse(sessionStorage.getItem("dropdowns")).liabilityOption,G=JSON.parse(sessionStorage.getItem("logInUserData")),V=Object.keys(U).map((function(e){var t,n;return{value:e,label:null!==(t=null===k||void 0===k||null===(n=k.colorOption)||void 0===n?void 0:n[e])&&void 0!==t?t:e,color:"#00B8D9",isFixed:!0}})),X=(0,r.createRef)(),Q=(0,r.useState)(!1),W=(0,s.Z)(Q,2),Y=W[0],H=W[1],K=(0,r.useState)(!1),$=(0,s.Z)(K,2),q=$[0],ee=$[1],te=(0,r.useState)(null),ne=(0,s.Z)(te,2),ie=ne[0],ae=ne[1],le=(0,r.useState)(""),oe=(0,s.Z)(le,2),se=oe[0],re=oe[1],ue=(0,r.useState)(""),de=(0,s.Z)(ue,2),ce=de[0],ve=de[1],fe=(0,r.useState)(!0),pe=(0,s.Z)(fe,2),he=pe[0],me=pe[1],ye=(0,r.useState)([]),xe=(0,s.Z)(ye,2),ge=xe[0],be=xe[1],Ze=(0,r.useState)(""),ke=(0,s.Z)(Ze,2),Se=ke[0],je=ke[1],Ae=(0,r.useState)(!1),De=(0,s.Z)(Ae,2),we=De[0],Le=De[1],Ce=(0,r.useState)(!1),Pe=(0,s.Z)(Ce,2),Ie=Pe[0],Fe=Pe[1],Ne=(0,r.useState)(null),Ee=(0,s.Z)(Ne,2),Oe=Ee[0],Be=Ee[1],_e=(0,r.useState)(!1),ze=(0,s.Z)(_e,2),Me=ze[0],Te=ze[1],Re=(0,r.useState)(!1),Je=(0,s.Z)(Re,2),Ue=Je[0],Ge=Je[1],Ve=(0,r.useState)(!1),Xe=(0,s.Z)(Ve,2),Qe=Xe[0],We=Xe[1],Ye=(0,r.useState)([]),He=(0,s.Z)(Ye,2),Ke=He[0],$e=He[1],qe=(0,r.useState)(!1),et=(0,s.Z)(qe,2),tt=et[0],nt=et[1],it=(0,r.useState)(),at=(0,s.Z)(it,2),lt=at[0],ot=at[1],st=(0,r.useState)([]),rt=(0,s.Z)(st,2),ut=rt[0],dt=rt[1],ct=(0,r.useState)(""),vt=(0,s.Z)(ct,2),ft=vt[0],pt=vt[1],ht=(0,r.useState)(!1),mt=(0,s.Z)(ht,2),yt=mt[0],xt=mt[1],gt=(0,r.useState)(""),bt=(0,s.Z)(gt,2),Zt=bt[0],kt=bt[1],St=(0,r.useState)(!0),jt=(0,s.Z)(St,2),At=jt[0],Dt=jt[1],wt=(0,r.useState)(!1),Lt=(0,s.Z)(wt,2),Ct=Lt[0],Pt=Lt[1],It=(0,r.useState)(),Ft=(0,s.Z)(It,2),Nt=Ft[0],Et=Ft[1],Ot=(0,r.useState)([{value:"Add Nominee",label:"Add Nominee",color:"#00B8D9",isFixed:!1}]),Bt=(0,s.Z)(Ot,2),_t=Bt[0],zt=Bt[1];(0,r.useEffect)((function(){if(e.dataList.data.length){var t=[{value:"Add Nominee",label:"Add Nominee",color:"#00B8D9",isFixed:!1}];e.dataList.data.forEach((function(e){var n={value:e._id,label:"".concat(e.name," - ").concat(e.relation),color:"#00B8D9",isFixed:!1};t.push(n)})),zt(t)}}),[e.dataList]),(0,r.useEffect)((function(){z&&F(e.dataList,Jt,qt,ae,H,be,z)}),[z]),(0,r.useEffect)((function(){!e.listLoading&&C(),_()}),[]);var Mt=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Le(e),!0===t&&(Be(null),Fe(!0))},Tt=function(){var t=(0,o.Z)((0,l.Z)().mark((function t(n){return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Te(!0),t.prev=1,t.next=4,e.addData(n);case 4:Te(!1),Mt(!1,!0),t.next=12;break;case 8:return t.prev=8,t.t0=t.catch(1),Te(!1),t.abrupt("return",(0,I.jsx)(A.A9,{handleClick:function(){},openSnack:!0,openSnackMsg:"Add Nominee Failed! Please contact admin",severity:"error"}));case 12:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(e){return t.apply(this,arguments)}}(),Rt=sessionStorage.getItem("authtoken");(0,r.useEffect)((function(){R&&(Et(R),Ge(!1))}),[R]);var Jt=function(){var e=(0,o.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,We(!0),Ge(!0),e.next=5,T(t);case 5:e.next=12;break;case 7:return e.prev=7,e.t0=e.catch(0),Ut(),We(!Qe),e.abrupt("return",(0,I.jsx)(A.A9,{handleClick:function(){},openSnack:!0,openSnackMsg:"Something went wrong",severity:"warning"}));case 12:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),Ut=function(){nt(!tt)},Gt=function(e,t,n){var i;"File"===t.type&&ot(null===(i=n.target)||void 0===i?void 0:i.files[0]);var a=ut,l=a.findIndex((function(e){return e.key===t.key}));e.length<50&&(a[l].val=e,dt(a),function(){var e=!1;ut.forEach((function(t){t.mandatory&&!t.val.trim()&&(e=!0)})),Dt(e)}(),ee(!q))},Vt=function(e){return new Promise((function(t,n){var i=new FileReader;i.readAsDataURL(e),i.onload=function(){return t(i.result)},i.onerror=function(e){return n(e)}}))},Xt=function(){var e=(0,o.Z)((0,l.Z)().mark((function e(t){var n,i,a,o,s,r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],(i={}).user=null===G||void 0===G?void 0:G._id,i.type="Liability",i.alias=(0,N.G)(t.name),e.next=7,Vt(t);case 7:return a=e.sent,o=(0,N.G)(a),s=c().compressToUTF16(o),n.push({media:s,name:t.name,type:t.type,user:null===G||void 0===G?void 0:G._id}),i.attachment=n,e.next=14,S().post("/backendapi/documents/add",i,{headers:{Authorization:"Bearer ".concat(sessionStorage.getItem("authtoken"))}});case 14:return r=e.sent,e.abrupt("return",r);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Qt=function(t){Pt(!0),t.preventDefault(),ft&&!lt&&ut.forEach((function(e){"Attachments"===e.key&&(e.val="")}));var n={liabilityType:Se,liabilityDetails:(0,D.OQ)(ut),nominees:Ke,id:Zt},i=z.findIndex((function(e){return e.id===Zt}));i>=0&&(z.splice(i,1),z.push(n),S().post("/backendapi/adddetails",{_id:null===G||void 0===G?void 0:G._id,liabilities:(0,N.G)(JSON.stringify(z)),nominees:Ke},{headers:{Authorization:"Bearer ".concat(sessionStorage.getItem("authtoken"))}}).then((function(t){var n;return ft&&(n=ft,S().delete("/backendapi/document/deletebyid/".concat(n),{headers:{Authorization:"Bearer ".concat(Rt)}}).then((function(e){return(0,I.jsx)(A.A9,{handleClick:function(){},openSnack:!0,openSnackMsg:ft&&lt?"Attachment Replaced Successfully":"Attachment removed Successfully"})})).catch((function(e){console.log("err",e)})).finally((function(){Kt(),$t(),Dt(!0)}))),C(e.parsedFilter),_(),Pt(!1),(0,I.jsx)(A.A9,{handleClick:function(){},openSnack:!0,openSnackMsg:"Updated successfully!"})})).catch((function(){Pt(!1)})),Kt(),$t(),Dt(!0))},Wt=function(e){Pt(!0),e.preventDefault(),xt(!1);var t=ut.findIndex((function(e){return"File"===e.type}));t>=0&&lt?""!==ut[t].val?Xt(lt).then((function(n){ut[t].val="".concat((0,N.Y)(n.data.alias),"#~#").concat(n.data._id,"#~#").concat(n.data.attachment[0]),dt(ut),Qt(e)})).catch((function(e){var t,n;Pt(!1),(null===e||void 0===e||null===(t=e.response)||void 0===t?void 0:t.data)&&(A.A9,null===e||void 0===e||null===(n=e.response)||void 0===n||n.data)})):Qt(e):Qt(e)},Yt=function(){var t={liabilityType:Se,liabilityDetails:(0,D.OQ)(ut),nominees:Ke,id:(0,u.Z)()};return Ke.forEach((function(e){e.objectid=t.id})),z.push(t),S().post("/backendapi/adddetails",{_id:null===G||void 0===G?void 0:G._id,liabilities:(0,N.G)(JSON.stringify(z)),nominees:Ke},{headers:{Authorization:"Bearer ".concat(sessionStorage.getItem("authtoken"))}}).then((function(t){C(e.parsedFilter),_(),Pt(!1)})).catch((function(){Pt(!1)})),Kt(),$t(),Dt(!0),(0,I.jsx)(A.A9,{handleClick:function(){},openSnack:!0,openSnackMsg:"Liability addedd successfully!"})},Ht=function(e){Pt(!0),e.preventDefault();var t=ut.findIndex((function(e){return"File"===e.type}));t>=0?""!==ut[t].val?Xt(lt).then((function(e){ut[t].val="".concat((0,N.Y)(e.data.alias),"#~#").concat(e.data._id,"#~#").concat(e.data.attachment[0]),dt(ut),Yt()})).catch((function(e){var t,n;Pt(!1),(null===e||void 0===e||null===(t=e.response)||void 0===t?void 0:t.data)&&(A.A9,null===e||void 0===e||null===(n=e.response)||void 0===n||n.data)})):Yt():Yt()},Kt=function(){z&&F(e.dataList,Jt,qt,ae,H,be,z),je(""),pt(""),ot(""),dt([]),$e([]),yt&&Dt(!0)},$t=function(){re(""),ve(""),X.current&&X.current.select.clearValue()},qt=function(e){var t=e.liabilityDetails,n=e.liabilityType,i=e.nominees;je(n),xt(!0),kt(e.id),dt(t),$e((0,a.Z)(i))};return(0,I.jsxs)(v.Z,{children:[(0,I.jsx)(O.zV,{prviewmodal:Qe,setprviewmodal:We,loading:Ue,blobUrl:Nt,reset:function(){J()}}),(0,I.jsx)(g.Z,{modalMessage:"Are you sure you want to delete this record?",handleConfirm:function(){!function(e){var t=JSON.parse(JSON.stringify(z)),n=t.findIndex((function(t){return t.id===e})),i=[];if(console.log(n,"id"),n>=0){var a=t[n].liabilityDetails.filter((function(e){return"File"===e.type}));console.log(a),a.forEach((function(e){var t=e.val.split("#~#");null!==t&&void 0!==t&&t[1]&&(console.log("liability delete",t),S().delete("/backendapi/document/deletebyid/".concat(t[1]),{headers:{Authorization:"Bearer ".concat(sessionStorage.getItem("authtoken"))}}))})),t[n].nominees.forEach((function(e){e.objectid=t[n].id,i.push(e)})),t.splice(n,1),M({_id:null===G||void 0===G?void 0:G._id,liabilities:(0,N.G)(JSON.stringify(t)),nominees:Ke,deletednominee:i}),Kt(),$t(),Dt(!0),A.A9}}(ie),H(!1)},isOpen:Y,closeModal:function(){return H(!1)}}),(0,I.jsx)(E.Z,{show:we,data:Oe,updateData:e.updateData,addData:Tt,isLoading:Me,handleSidebar:Mt,thumbView:j,getData:C,dataParams:B,addNew:Ie}),(0,I.jsxs)(f.ZP,{container:!0,spacing:2,sx:{p:.5},children:[(0,I.jsx)(f.ZP,{item:!0,xs:12,sm:8,children:(0,I.jsxs)(p.Z,{children:[(0,I.jsx)(A.ll,{title:(null!==(t=null===k||void 0===k?void 0:k.subHeading)&&void 0!==t?t:yt)?"Edit Liability Details":"Add New Liability"}),(0,I.jsxs)(h.Z,{children:[(0,I.jsxs)(f.ZP,{container:!0,spacing:1,children:[(0,I.jsx)(f.ZP,{item:!0,xs:12,sm:6,children:(0,I.jsx)(w.gc,{name:"liability",isDisabled:yt,options:V,id:"liabilityID",onChange:function(e,t){return function(e){var t;Dt(!0),(0,D.L9)(),re(""),ve(""),$e([]),ot(""),je(null!==(t=null===e||void 0===e?void 0:e.value)&&void 0!==t?t:void 0),dt(e?U[e.value]:{})}(t)},value:(0,D.NA)(V,Se),renderInput:function(e){var t;return(0,I.jsx)(x.Z,(0,i.Z)((0,i.Z)({},e),{},{placeholder:null!==(t=null===k||void 0===k?void 0:k.liabilityOptionText)&&void 0!==t?t:"Liability Type"}))}})}),(0,I.jsx)(f.ZP,{item:!0,xs:12,sm:6,children:(0,I.jsx)(w.gc,{isMulti:!0,id:"nominee",name:"nominee",options:_t,value:Ke.map((function(e){var t=_t.filter((function(t){return t.value===e.id}));return{value:t[0].value,label:t[0].label}})),onChange:function(e,t){return function(e){yt&&Dt(!1);var t=[];(null===e||void 0===e?void 0:e.length)&&e.forEach((function(e){"Add Nominee"===e.value?Le(!0):t.push({id:e.value,name:e.label})})),$e([].concat(t))}(t)},renderInput:function(e){var t;return(0,I.jsx)(x.Z,(0,i.Z)((0,i.Z)({},e),{},{placeholder:null!==(t=null===k||void 0===k?void 0:k.nomineeOption)&&void 0!==t?t:"Nominee(s)"}))}})}),Object.keys(U).includes(Se)&&ut.map((function(e,t){return(0,I.jsx)(f.ZP,{item:!0,xs:12,sm:6,children:"Attachments"!==e.key?(0,I.jsxs)(I.Fragment,{children:[e.deletable&&(0,I.jsx)(L.Z,{style:{position:"absolute",right:"-5px",top:"-7px"},className:"primary",size:15,onClick:function(){return function(e){yt&&Dt(!1);var t=ut.filter((function(t){return e.key!==t.key}));dt(t)}(e)}}),(0,I.jsx)(x.Z,{margin:"normal",size:"small",fullWidth:!0,type:e.type,onKeyPress:function(t){"number"===e.type.toLowerCase()&&((0,P.ZP)(t),function(e){var t=(null===e||void 0===e?void 0:e.keyCode)||(null===e||void 0===e?void 0:e.which),n=document.getElementById("liabSubmit");13===t&&(!n||n.disabled||Ct||(yt?Wt(e):Ht(e)))}(t))},name:e.key,id:e.id,rows:"1",className:"input-label placeholder ",placeholder:e.key,max:"9999-12-31",min:"1900-01-01",value:"File"!==e.type?e.val:null,onChange:function(t){Gt(t.target?t.target.value:t.value,e,t)}})]}):yt&&!ft&&e.val.split("#~#")[1]?(0,I.jsxs)("div",{className:"form-control",children:[(0,I.jsx)(L.Z,{style:{position:"absolute",right:"-5px",top:"-7px"},className:"primary",size:15,onClick:function(){pt(e.val.split("#~#")[1])}}),(0,I.jsx)("span",{style:{color:"blue"},onClick:function(){Jt(e.val.split("#~#")[2])},children:e.val.split("#~#")[0]})]}):(0,I.jsx)(x.Z,{margin:"normal",size:"small",fullWidth:!0,type:e.type,value:null,id:"fileAtt",onChange:function(t){Gt(t.target?t.target.value:t.value,e,t)}})},t)}))]}),(0,I.jsxs)(m.Z,{direction:"row",spacing:3,sx:{mt:3},justifyContent:"end",children:[Se&&(0,I.jsx)(y.Z,{onClick:Ut,children:"Add Custom Field"}),(0,I.jsx)(w.ZP,{varient:"outlined",label:yt?"Cancel":null!==(n=null===k||void 0===k?void 0:k.resetButton)&&void 0!==n?n:"Reset",onClick:function(e){xt(!1),Kt()}}),(0,I.jsx)(w.ZP,{varient:"contained",id:"assetSubmit",spinload:Ct,label:yt?"Update":null!==(d=null===k||void 0===k?void 0:k.submitButton)&&void 0!==d?d:"Add",disabled:!ft&&(0===Ke.length||!Se||At||Ct),onClick:function(e){yt?Wt(e):Ht(e)}})]})]})]})}),(0,I.jsx)(b.Z,{}),(0,I.jsx)(f.ZP,{item:!0,xs:12,children:(0,I.jsx)(Z.ZP,{heading:null!==k&&void 0!==k&&k.textList?k.textList:"Liabilities List",isLoading:e.listLoading,collapseItems:ge,show:function(){me(!he),_()},assetShow:he})})]}),(0,I.jsx)(O.Id,{modal:tt,fname:se,ftype:ce,loading:Ue,addfield:function(){if(""!==Se){var e=ut,t=e.length,n="";if(e.findIndex((function(e){return e.key===se}))>=0)return(0,I.jsx)(A.A9,{handleClick:function(){},openSnack:!0,openSnackMsg:"Field Already Exist! Please add new field",severity:"error"});"Attachments"===ut[t-1].key?(n=e[t-1],e[t-1]={key:se,val:"",type:ce,deletable:!0},e.push(n),dt(e),re(""),ve("")):(e.push({key:se,val:"",type:ce,deletable:!0}),dt(e),re(""),ve("")),Ut()}},messages:k,setfname:re,setftype:ve,assetType:Se,toggleModal:Ut,selectCustomRef:X,clearCustomField:$t})]})}))}}]);